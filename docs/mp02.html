<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.22">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>mp02 â€“ STA 9750 Submission Material</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark-fbf3368e9a39f98674df9137282eadca.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-6f7c197ed6a36c53ce5b7d921c455e96.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<link href="site_libs/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet">

<script src="site_libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>

<link href="site_libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet">

<script src="site_libs/datatables-binding-0.34.0/datatables.js"></script>

<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>

<link href="site_libs/dt-core-1.13.6/css/jquery.dataTables.min.css" rel="stylesheet">

<link href="site_libs/dt-core-1.13.6/css/jquery.dataTables.extra.css" rel="stylesheet">

<script src="site_libs/dt-core-1.13.6/js/jquery.dataTables.min.js"></script>

<link href="site_libs/crosstalk-1.2.1/css/crosstalk.min.css" rel="stylesheet">

<script src="site_libs/crosstalk-1.2.1/js/crosstalk.min.js"></script>



</head>

<body class="nav-fixed fullcontent quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="./index.html" class="navbar-brand navbar-brand-logo">
    </a>
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">STA 9750 Submission Material</span>
    </a>
  </div>
        <div class="quarto-navbar-tools tools-end">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">mp02</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="sc">!</span><span class="fu">dir.exists</span>(<span class="fu">file.path</span>(<span class="st">"data"</span>, <span class="st">"mp02"</span>))){</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">dir.create</span>(<span class="fu">file.path</span>(<span class="st">"data"</span>, <span class="st">"mp02"</span>), <span class="at">showWarnings=</span><span class="cn">FALSE</span>, <span class="at">recursive=</span><span class="cn">TRUE</span>)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>library <span class="ot">&lt;-</span> <span class="cf">function</span>(pkg){</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>    <span class="do">## Mask base::library() to automatically install packages if needed</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>    <span class="do">## Masking is important here so downlit picks up packages and links</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>    <span class="do">## to documentation</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>    pkg <span class="ot">&lt;-</span> <span class="fu">as.character</span>(<span class="fu">substitute</span>(pkg))</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">options</span>(<span class="at">repos =</span> <span class="fu">c</span>(<span class="at">CRAN =</span> <span class="st">"https://cloud.r-project.org"</span>))</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(<span class="sc">!</span><span class="fu">require</span>(pkg, <span class="at">character.only=</span><span class="cn">TRUE</span>, <span class="at">quietly=</span><span class="cn">TRUE</span>)) <span class="fu">install.packages</span>(pkg)</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stopifnot</span>(<span class="fu">require</span>(pkg, <span class="at">character.only=</span><span class="cn">TRUE</span>, <span class="at">quietly=</span><span class="cn">TRUE</span>))</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(glue)</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl)</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidycensus)</span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>get_acs_all_years <span class="ot">&lt;-</span> <span class="cf">function</span>(variable, <span class="at">geography=</span><span class="st">"cbsa"</span>,</span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a>                              <span class="at">start_year=</span><span class="dv">2009</span>, <span class="at">end_year=</span><span class="dv">2023</span>){</span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>    fname <span class="ot">&lt;-</span> <span class="fu">glue</span>(<span class="st">"{variable}_{geography}_{start_year}_{end_year}.csv"</span>)</span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a>    fname <span class="ot">&lt;-</span> <span class="fu">file.path</span>(<span class="st">"data"</span>, <span class="st">"mp02"</span>, fname)</span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(<span class="sc">!</span><span class="fu">file.exists</span>(fname)){</span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a>        YEARS <span class="ot">&lt;-</span> <span class="fu">seq</span>(start_year, end_year)</span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a>        YEARS <span class="ot">&lt;-</span> YEARS[YEARS <span class="sc">!=</span> <span class="dv">2020</span>] <span class="co"># Drop 2020 - No survey (covid)</span></span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a>        ALL_DATA <span class="ot">&lt;-</span> <span class="fu">map</span>(YEARS, <span class="cf">function</span>(yy){</span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a>            tidycensus<span class="sc">::</span><span class="fu">get_acs</span>(geography, variable, <span class="at">year=</span>yy, <span class="at">survey=</span><span class="st">"acs1"</span>) <span class="sc">|&gt;</span></span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a>                <span class="fu">mutate</span>(<span class="at">year=</span>yy) <span class="sc">|&gt;</span></span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a>                <span class="fu">select</span>(<span class="sc">-</span>moe, <span class="sc">-</span>variable) <span class="sc">|&gt;</span></span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a>                <span class="fu">rename</span>(<span class="sc">!!</span><span class="at">variable :=</span> estimate)</span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a>        }) <span class="sc">|&gt;</span> <span class="fu">bind_rows</span>()</span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb1-36"><a href="#cb1-36" aria-hidden="true" tabindex="-1"></a>        <span class="fu">write_csv</span>(ALL_DATA, fname)</span>
<span id="cb1-37"><a href="#cb1-37" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb1-38"><a href="#cb1-38" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1-39"><a href="#cb1-39" aria-hidden="true" tabindex="-1"></a>    <span class="fu">read_csv</span>(fname, <span class="at">show_col_types=</span><span class="cn">FALSE</span>)</span>
<span id="cb1-40"><a href="#cb1-40" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-41"><a href="#cb1-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-42"><a href="#cb1-42" aria-hidden="true" tabindex="-1"></a><span class="co"># Household income (12 month)</span></span>
<span id="cb1-43"><a href="#cb1-43" aria-hidden="true" tabindex="-1"></a>INCOME <span class="ot">&lt;-</span> <span class="fu">get_acs_all_years</span>(<span class="st">"B19013_001"</span>) <span class="sc">|&gt;</span></span>
<span id="cb1-44"><a href="#cb1-44" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rename</span>(<span class="at">household_income =</span> B19013_001)</span>
<span id="cb1-45"><a href="#cb1-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-46"><a href="#cb1-46" aria-hidden="true" tabindex="-1"></a><span class="co"># Monthly rent</span></span>
<span id="cb1-47"><a href="#cb1-47" aria-hidden="true" tabindex="-1"></a>RENT <span class="ot">&lt;-</span> <span class="fu">get_acs_all_years</span>(<span class="st">"B25064_001"</span>) <span class="sc">|&gt;</span></span>
<span id="cb1-48"><a href="#cb1-48" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rename</span>(<span class="at">monthly_rent =</span> B25064_001)</span>
<span id="cb1-49"><a href="#cb1-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-50"><a href="#cb1-50" aria-hidden="true" tabindex="-1"></a><span class="co"># Total population</span></span>
<span id="cb1-51"><a href="#cb1-51" aria-hidden="true" tabindex="-1"></a>POPULATION <span class="ot">&lt;-</span> <span class="fu">get_acs_all_years</span>(<span class="st">"B01003_001"</span>) <span class="sc">|&gt;</span></span>
<span id="cb1-52"><a href="#cb1-52" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rename</span>(<span class="at">population =</span> B01003_001)</span>
<span id="cb1-53"><a href="#cb1-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-54"><a href="#cb1-54" aria-hidden="true" tabindex="-1"></a><span class="co"># Total number of households</span></span>
<span id="cb1-55"><a href="#cb1-55" aria-hidden="true" tabindex="-1"></a>HOUSEHOLDS <span class="ot">&lt;-</span> <span class="fu">get_acs_all_years</span>(<span class="st">"B11001_001"</span>) <span class="sc">|&gt;</span></span>
<span id="cb1-56"><a href="#cb1-56" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rename</span>(<span class="at">households =</span> B11001_001)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>get_building_permits <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">start_year =</span> <span class="dv">2009</span>, <span class="at">end_year =</span> <span class="dv">2023</span>){</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>    fname <span class="ot">&lt;-</span> <span class="fu">glue</span>(<span class="st">"housing_units_{start_year}_{end_year}.csv"</span>)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>    fname <span class="ot">&lt;-</span> <span class="fu">file.path</span>(<span class="st">"data"</span>, <span class="st">"mp02"</span>, fname)</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(<span class="sc">!</span><span class="fu">file.exists</span>(fname)){</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>        HISTORICAL_YEARS <span class="ot">&lt;-</span> <span class="fu">seq</span>(start_year, <span class="dv">2018</span>)</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>        HISTORICAL_DATA <span class="ot">&lt;-</span> <span class="fu">map</span>(HISTORICAL_YEARS, <span class="cf">function</span>(yy){</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>            historical_url <span class="ot">&lt;-</span> <span class="fu">glue</span>(<span class="st">"https://www.census.gov/construction/bps/txt/tb3u{yy}.txt"</span>)</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>            LINES <span class="ot">&lt;-</span> <span class="fu">readLines</span>(historical_url)[<span class="sc">-</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">11</span>)]</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>            CBSA_LINES <span class="ot">&lt;-</span> <span class="fu">str_detect</span>(LINES, <span class="st">"^[[:digit:]]"</span>)</span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>            CBSA <span class="ot">&lt;-</span> <span class="fu">as.integer</span>(<span class="fu">str_sub</span>(LINES[CBSA_LINES], <span class="dv">5</span>, <span class="dv">10</span>))</span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>            PERMIT_LINES <span class="ot">&lt;-</span> <span class="fu">str_detect</span>(<span class="fu">str_sub</span>(LINES, <span class="dv">48</span>, <span class="dv">53</span>), <span class="st">"[[:digit:]]"</span>)</span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>            PERMITS <span class="ot">&lt;-</span> <span class="fu">as.integer</span>(<span class="fu">str_sub</span>(LINES[PERMIT_LINES], <span class="dv">48</span>, <span class="dv">53</span>))</span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a>            <span class="fu">data_frame</span>(<span class="at">CBSA =</span> CBSA,</span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>                       <span class="at">new_housing_units_permitted =</span> PERMITS, </span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a>                       <span class="at">year =</span> yy)</span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a>        }) <span class="sc">|&gt;</span> <span class="fu">bind_rows</span>()</span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a>        CURRENT_YEARS <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">2019</span>, end_year)</span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a>        CURRENT_DATA <span class="ot">&lt;-</span> <span class="fu">map</span>(CURRENT_YEARS, <span class="cf">function</span>(yy){</span>
<span id="cb2-27"><a href="#cb2-27" aria-hidden="true" tabindex="-1"></a>            current_url <span class="ot">&lt;-</span> <span class="fu">glue</span>(<span class="st">"https://www.census.gov/construction/bps/xls/msaannual_{yy}99.xls"</span>)</span>
<span id="cb2-28"><a href="#cb2-28" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb2-29"><a href="#cb2-29" aria-hidden="true" tabindex="-1"></a>            temp <span class="ot">&lt;-</span> <span class="fu">tempfile</span>()</span>
<span id="cb2-30"><a href="#cb2-30" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb2-31"><a href="#cb2-31" aria-hidden="true" tabindex="-1"></a>            <span class="fu">download.file</span>(current_url, <span class="at">destfile =</span> temp, <span class="at">mode=</span><span class="st">"wb"</span>)</span>
<span id="cb2-32"><a href="#cb2-32" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb2-33"><a href="#cb2-33" aria-hidden="true" tabindex="-1"></a>            fallback <span class="ot">&lt;-</span> <span class="cf">function</span>(.f1, .f2){</span>
<span id="cb2-34"><a href="#cb2-34" aria-hidden="true" tabindex="-1"></a>                <span class="cf">function</span>(...){</span>
<span id="cb2-35"><a href="#cb2-35" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">tryCatch</span>(<span class="fu">.f1</span>(...), </span>
<span id="cb2-36"><a href="#cb2-36" aria-hidden="true" tabindex="-1"></a>                             <span class="at">error=</span><span class="cf">function</span>(e) <span class="fu">.f2</span>(...))</span>
<span id="cb2-37"><a href="#cb2-37" aria-hidden="true" tabindex="-1"></a>                }</span>
<span id="cb2-38"><a href="#cb2-38" aria-hidden="true" tabindex="-1"></a>            }</span>
<span id="cb2-39"><a href="#cb2-39" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb2-40"><a href="#cb2-40" aria-hidden="true" tabindex="-1"></a>            reader <span class="ot">&lt;-</span> <span class="fu">fallback</span>(read_xlsx, read_xls)</span>
<span id="cb2-41"><a href="#cb2-41" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb2-42"><a href="#cb2-42" aria-hidden="true" tabindex="-1"></a>            <span class="fu">reader</span>(temp, <span class="at">skip=</span><span class="dv">5</span>) <span class="sc">|&gt;</span></span>
<span id="cb2-43"><a href="#cb2-43" aria-hidden="true" tabindex="-1"></a>                <span class="fu">na.omit</span>() <span class="sc">|&gt;</span></span>
<span id="cb2-44"><a href="#cb2-44" aria-hidden="true" tabindex="-1"></a>                <span class="fu">select</span>(CBSA, Total) <span class="sc">|&gt;</span></span>
<span id="cb2-45"><a href="#cb2-45" aria-hidden="true" tabindex="-1"></a>                <span class="fu">mutate</span>(<span class="at">year =</span> yy) <span class="sc">|&gt;</span></span>
<span id="cb2-46"><a href="#cb2-46" aria-hidden="true" tabindex="-1"></a>                <span class="fu">rename</span>(<span class="at">new_housing_units_permitted =</span> Total)</span>
<span id="cb2-47"><a href="#cb2-47" aria-hidden="true" tabindex="-1"></a>        }) <span class="sc">|&gt;</span> <span class="fu">bind_rows</span>()</span>
<span id="cb2-48"><a href="#cb2-48" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb2-49"><a href="#cb2-49" aria-hidden="true" tabindex="-1"></a>        ALL_DATA <span class="ot">&lt;-</span> <span class="fu">rbind</span>(HISTORICAL_DATA, CURRENT_DATA)</span>
<span id="cb2-50"><a href="#cb2-50" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb2-51"><a href="#cb2-51" aria-hidden="true" tabindex="-1"></a>        <span class="fu">write_csv</span>(ALL_DATA, fname)</span>
<span id="cb2-52"><a href="#cb2-52" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb2-53"><a href="#cb2-53" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb2-54"><a href="#cb2-54" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb2-55"><a href="#cb2-55" aria-hidden="true" tabindex="-1"></a>    <span class="fu">read_csv</span>(fname, <span class="at">show_col_types=</span><span class="cn">FALSE</span>)</span>
<span id="cb2-56"><a href="#cb2-56" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb2-57"><a href="#cb2-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-58"><a href="#cb2-58" aria-hidden="true" tabindex="-1"></a>PERMITS <span class="ot">&lt;-</span> <span class="fu">get_building_permits</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(httr2)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rvest)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>get_bls_industry_codes <span class="ot">&lt;-</span> <span class="cf">function</span>(){</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>    fname <span class="ot">&lt;-</span> <span class="fu">file.path</span>(<span class="st">"data"</span>, <span class="st">"mp02"</span>, <span class="st">"bls_industry_codes.csv"</span>)</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">library</span>(dplyr)</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">library</span>(tidyr)</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">library</span>(readr)</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(<span class="sc">!</span><span class="fu">file.exists</span>(fname)){</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>        resp <span class="ot">&lt;-</span> <span class="fu">request</span>(<span class="st">"https://www.bls.gov"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>            <span class="fu">req_url_path</span>(<span class="st">"cew"</span>, <span class="st">"classifications"</span>, <span class="st">"industry"</span>, <span class="st">"industry-titles.htm"</span>) <span class="sc">|&gt;</span></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>            <span class="fu">req_headers</span>(<span class="st">`</span><span class="at">User-Agent</span><span class="st">`</span> <span class="ot">=</span> <span class="st">"Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:143.0) Gecko/20100101 Firefox/143.0"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>            <span class="fu">req_error</span>(<span class="at">is_error =</span> \(resp) <span class="cn">FALSE</span>) <span class="sc">|&gt;</span></span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>            <span class="fu">req_perform</span>()</span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>        <span class="fu">resp_check_status</span>(resp)</span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a>        naics_table <span class="ot">&lt;-</span> <span class="fu">resp_body_html</span>(resp) <span class="sc">|&gt;</span></span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a>            <span class="fu">html_element</span>(<span class="st">"#naics_titles"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a>            <span class="fu">html_table</span>() <span class="sc">|&gt;</span></span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a>            <span class="fu">mutate</span>(<span class="at">title =</span> <span class="fu">str_trim</span>(<span class="fu">str_remove</span>(<span class="fu">str_remove</span>(<span class="st">`</span><span class="at">Industry Title</span><span class="st">`</span>, Code), <span class="st">"NAICS"</span>))) <span class="sc">|&gt;</span></span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a>            <span class="fu">select</span>(<span class="sc">-</span><span class="st">`</span><span class="at">Industry Title</span><span class="st">`</span>) <span class="sc">|&gt;</span></span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a>            <span class="fu">mutate</span>(<span class="at">depth =</span> <span class="fu">if_else</span>(<span class="fu">nchar</span>(Code) <span class="sc">&lt;=</span> <span class="dv">5</span>, <span class="fu">nchar</span>(Code) <span class="sc">-</span> <span class="dv">1</span>, <span class="cn">NA</span>)) <span class="sc">|&gt;</span></span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a>            <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(depth))</span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb3-27"><a href="#cb3-27" aria-hidden="true" tabindex="-1"></a>        <span class="co"># These were looked up manually on bls.gov after finding </span></span>
<span id="cb3-28"><a href="#cb3-28" aria-hidden="true" tabindex="-1"></a>        <span class="co"># they were presented as ranges. Since there are only three</span></span>
<span id="cb3-29"><a href="#cb3-29" aria-hidden="true" tabindex="-1"></a>        <span class="co"># it was easier to manually handle than to special-case everything else</span></span>
<span id="cb3-30"><a href="#cb3-30" aria-hidden="true" tabindex="-1"></a>        naics_missing <span class="ot">&lt;-</span> tibble<span class="sc">::</span><span class="fu">tribble</span>(</span>
<span id="cb3-31"><a href="#cb3-31" aria-hidden="true" tabindex="-1"></a>            <span class="sc">~</span>Code, <span class="sc">~</span>title, <span class="sc">~</span>depth, </span>
<span id="cb3-32"><a href="#cb3-32" aria-hidden="true" tabindex="-1"></a>            <span class="st">"31"</span>, <span class="st">"Manufacturing"</span>, <span class="dv">1</span>,</span>
<span id="cb3-33"><a href="#cb3-33" aria-hidden="true" tabindex="-1"></a>            <span class="st">"32"</span>, <span class="st">"Manufacturing"</span>, <span class="dv">1</span>,</span>
<span id="cb3-34"><a href="#cb3-34" aria-hidden="true" tabindex="-1"></a>            <span class="st">"33"</span>, <span class="st">"Manufacturing"</span>, <span class="dv">1</span>,</span>
<span id="cb3-35"><a href="#cb3-35" aria-hidden="true" tabindex="-1"></a>            <span class="st">"44"</span>, <span class="st">"Retail"</span>, <span class="dv">1</span>, </span>
<span id="cb3-36"><a href="#cb3-36" aria-hidden="true" tabindex="-1"></a>            <span class="st">"45"</span>, <span class="st">"Retail"</span>, <span class="dv">1</span>,</span>
<span id="cb3-37"><a href="#cb3-37" aria-hidden="true" tabindex="-1"></a>            <span class="st">"48"</span>, <span class="st">"Transportation and Warehousing"</span>, <span class="dv">1</span>, </span>
<span id="cb3-38"><a href="#cb3-38" aria-hidden="true" tabindex="-1"></a>            <span class="st">"49"</span>, <span class="st">"Transportation and Warehousing"</span>, <span class="dv">1</span></span>
<span id="cb3-39"><a href="#cb3-39" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb3-40"><a href="#cb3-40" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb3-41"><a href="#cb3-41" aria-hidden="true" tabindex="-1"></a>        naics_table <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(naics_table, naics_missing)</span>
<span id="cb3-42"><a href="#cb3-42" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb3-43"><a href="#cb3-43" aria-hidden="true" tabindex="-1"></a>        naics_table <span class="ot">&lt;-</span> naics_table <span class="sc">|&gt;</span> </span>
<span id="cb3-44"><a href="#cb3-44" aria-hidden="true" tabindex="-1"></a>            <span class="fu">filter</span>(depth <span class="sc">==</span> <span class="dv">4</span>) <span class="sc">|&gt;</span> </span>
<span id="cb3-45"><a href="#cb3-45" aria-hidden="true" tabindex="-1"></a>            <span class="fu">rename</span>(<span class="at">level4_title=</span>title) <span class="sc">|&gt;</span> </span>
<span id="cb3-46"><a href="#cb3-46" aria-hidden="true" tabindex="-1"></a>            <span class="fu">mutate</span>(<span class="at">level1_code =</span> <span class="fu">str_sub</span>(Code, <span class="at">end=</span><span class="dv">2</span>), </span>
<span id="cb3-47"><a href="#cb3-47" aria-hidden="true" tabindex="-1"></a>                   <span class="at">level2_code =</span> <span class="fu">str_sub</span>(Code, <span class="at">end=</span><span class="dv">3</span>), </span>
<span id="cb3-48"><a href="#cb3-48" aria-hidden="true" tabindex="-1"></a>                   <span class="at">level3_code =</span> <span class="fu">str_sub</span>(Code, <span class="at">end=</span><span class="dv">4</span>)) <span class="sc">|&gt;</span></span>
<span id="cb3-49"><a href="#cb3-49" aria-hidden="true" tabindex="-1"></a>            <span class="fu">left_join</span>(naics_table, <span class="fu">join_by</span>(level1_code <span class="sc">==</span> Code)) <span class="sc">|&gt;</span></span>
<span id="cb3-50"><a href="#cb3-50" aria-hidden="true" tabindex="-1"></a>            <span class="fu">rename</span>(<span class="at">level1_title=</span>title) <span class="sc">|&gt;</span></span>
<span id="cb3-51"><a href="#cb3-51" aria-hidden="true" tabindex="-1"></a>            <span class="fu">left_join</span>(naics_table, <span class="fu">join_by</span>(level2_code <span class="sc">==</span> Code)) <span class="sc">|&gt;</span></span>
<span id="cb3-52"><a href="#cb3-52" aria-hidden="true" tabindex="-1"></a>            <span class="fu">rename</span>(<span class="at">level2_title=</span>title) <span class="sc">|&gt;</span></span>
<span id="cb3-53"><a href="#cb3-53" aria-hidden="true" tabindex="-1"></a>            <span class="fu">left_join</span>(naics_table, <span class="fu">join_by</span>(level3_code <span class="sc">==</span> Code)) <span class="sc">|&gt;</span></span>
<span id="cb3-54"><a href="#cb3-54" aria-hidden="true" tabindex="-1"></a>            <span class="fu">rename</span>(<span class="at">level3_title=</span>title) <span class="sc">|&gt;</span></span>
<span id="cb3-55"><a href="#cb3-55" aria-hidden="true" tabindex="-1"></a>            <span class="fu">select</span>(<span class="sc">-</span><span class="fu">starts_with</span>(<span class="st">"depth"</span>)) <span class="sc">|&gt;</span></span>
<span id="cb3-56"><a href="#cb3-56" aria-hidden="true" tabindex="-1"></a>            <span class="fu">rename</span>(<span class="at">level4_code =</span> Code) <span class="sc">|&gt;</span></span>
<span id="cb3-57"><a href="#cb3-57" aria-hidden="true" tabindex="-1"></a>            <span class="fu">select</span>(level1_title, level2_title, level3_title, level4_title, </span>
<span id="cb3-58"><a href="#cb3-58" aria-hidden="true" tabindex="-1"></a>                   level1_code,  level2_code,  level3_code,  level4_code) <span class="sc">|&gt;</span></span>
<span id="cb3-59"><a href="#cb3-59" aria-hidden="true" tabindex="-1"></a>            <span class="fu">drop_na</span>() <span class="sc">|&gt;</span></span>
<span id="cb3-60"><a href="#cb3-60" aria-hidden="true" tabindex="-1"></a>            <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">contains</span>(<span class="st">"code"</span>), as.integer))</span>
<span id="cb3-61"><a href="#cb3-61" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb3-62"><a href="#cb3-62" aria-hidden="true" tabindex="-1"></a>        <span class="fu">write_csv</span>(naics_table, fname)</span>
<span id="cb3-63"><a href="#cb3-63" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb3-64"><a href="#cb3-64" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb3-65"><a href="#cb3-65" aria-hidden="true" tabindex="-1"></a>    <span class="fu">read_csv</span>(fname, <span class="at">show_col_types=</span><span class="cn">FALSE</span>)</span>
<span id="cb3-66"><a href="#cb3-66" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb3-67"><a href="#cb3-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-68"><a href="#cb3-68" aria-hidden="true" tabindex="-1"></a>INDUSTRY_CODES <span class="ot">&lt;-</span> <span class="fu">get_bls_industry_codes</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(httr2)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rvest)</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>get_bls_qcew_annual_averages <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">start_year=</span><span class="dv">2009</span>, <span class="at">end_year=</span><span class="dv">2023</span>){</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>    fname <span class="ot">&lt;-</span> <span class="fu">glue</span>(<span class="st">"bls_qcew_{start_year}_{end_year}.csv.gz"</span>)</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>    fname <span class="ot">&lt;-</span> <span class="fu">file.path</span>(<span class="st">"data"</span>, <span class="st">"mp02"</span>, fname)</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>    YEARS <span class="ot">&lt;-</span> <span class="fu">seq</span>(start_year, end_year)</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>    YEARS <span class="ot">&lt;-</span> YEARS[YEARS <span class="sc">!=</span> <span class="dv">2020</span>] <span class="co"># Drop Covid year to match ACS</span></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(<span class="sc">!</span><span class="fu">file.exists</span>(fname)){</span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>        ALL_DATA <span class="ot">&lt;-</span> <span class="fu">map</span>(YEARS, <span class="at">.progress=</span><span class="cn">TRUE</span>, <span class="fu">possibly</span>(<span class="cf">function</span>(yy){</span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>            fname_inner <span class="ot">&lt;-</span> <span class="fu">file.path</span>(<span class="st">"data"</span>, <span class="st">"mp02"</span>, <span class="fu">glue</span>(<span class="st">"{yy}_qcew_annual_singlefile.zip"</span>))</span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span>(<span class="sc">!</span><span class="fu">file.exists</span>(fname_inner)){</span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a>                <span class="fu">request</span>(<span class="st">"https://www.bls.gov"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">req_url_path</span>(<span class="st">"cew"</span>, <span class="st">"data"</span>, <span class="st">"files"</span>, yy, <span class="st">"csv"</span>,</span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a>                                 <span class="fu">glue</span>(<span class="st">"{yy}_annual_singlefile.zip"</span>)) <span class="sc">|&gt;</span></span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">req_headers</span>(<span class="st">`</span><span class="at">User-Agent</span><span class="st">`</span> <span class="ot">=</span> <span class="st">"Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:143.0) Gecko/20100101 Firefox/143.0"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">req_retry</span>(<span class="at">max_tries=</span><span class="dv">5</span>) <span class="sc">|&gt;</span></span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">req_perform</span>(fname_inner)</span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a>            }</span>
<span id="cb4-22"><a href="#cb4-22" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb4-23"><a href="#cb4-23" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span>(<span class="fu">file.info</span>(fname_inner)<span class="sc">$</span>size <span class="sc">&lt;</span> <span class="fl">755e5</span>){</span>
<span id="cb4-24"><a href="#cb4-24" aria-hidden="true" tabindex="-1"></a>                <span class="fu">warning</span>(<span class="fu">sQuote</span>(fname_inner), <span class="st">"appears corrupted. Please delete and retry this step."</span>)</span>
<span id="cb4-25"><a href="#cb4-25" aria-hidden="true" tabindex="-1"></a>            }</span>
<span id="cb4-26"><a href="#cb4-26" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb4-27"><a href="#cb4-27" aria-hidden="true" tabindex="-1"></a>            <span class="fu">read_csv</span>(fname_inner, </span>
<span id="cb4-28"><a href="#cb4-28" aria-hidden="true" tabindex="-1"></a>                     <span class="at">show_col_types=</span><span class="cn">FALSE</span>) <span class="sc">|&gt;</span> </span>
<span id="cb4-29"><a href="#cb4-29" aria-hidden="true" tabindex="-1"></a>                <span class="fu">mutate</span>(<span class="at">YEAR =</span> yy) <span class="sc">|&gt;</span></span>
<span id="cb4-30"><a href="#cb4-30" aria-hidden="true" tabindex="-1"></a>                <span class="fu">select</span>(area_fips, </span>
<span id="cb4-31"><a href="#cb4-31" aria-hidden="true" tabindex="-1"></a>                       industry_code, </span>
<span id="cb4-32"><a href="#cb4-32" aria-hidden="true" tabindex="-1"></a>                       annual_avg_emplvl, </span>
<span id="cb4-33"><a href="#cb4-33" aria-hidden="true" tabindex="-1"></a>                       total_annual_wages, </span>
<span id="cb4-34"><a href="#cb4-34" aria-hidden="true" tabindex="-1"></a>                       YEAR) <span class="sc">|&gt;</span></span>
<span id="cb4-35"><a href="#cb4-35" aria-hidden="true" tabindex="-1"></a>                <span class="fu">filter</span>(<span class="fu">nchar</span>(industry_code) <span class="sc">&lt;=</span> <span class="dv">5</span>, </span>
<span id="cb4-36"><a href="#cb4-36" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">str_starts</span>(area_fips, <span class="st">"C"</span>)) <span class="sc">|&gt;</span></span>
<span id="cb4-37"><a href="#cb4-37" aria-hidden="true" tabindex="-1"></a>                <span class="fu">filter</span>(<span class="fu">str_detect</span>(industry_code, <span class="st">"-"</span>, <span class="at">negate=</span><span class="cn">TRUE</span>)) <span class="sc">|&gt;</span></span>
<span id="cb4-38"><a href="#cb4-38" aria-hidden="true" tabindex="-1"></a>                <span class="fu">mutate</span>(<span class="at">FIPS =</span> area_fips, </span>
<span id="cb4-39"><a href="#cb4-39" aria-hidden="true" tabindex="-1"></a>                       <span class="at">INDUSTRY =</span> <span class="fu">as.integer</span>(industry_code), </span>
<span id="cb4-40"><a href="#cb4-40" aria-hidden="true" tabindex="-1"></a>                       <span class="at">EMPLOYMENT =</span> <span class="fu">as.integer</span>(annual_avg_emplvl), </span>
<span id="cb4-41"><a href="#cb4-41" aria-hidden="true" tabindex="-1"></a>                       <span class="at">TOTAL_WAGES =</span> total_annual_wages) <span class="sc">|&gt;</span></span>
<span id="cb4-42"><a href="#cb4-42" aria-hidden="true" tabindex="-1"></a>                <span class="fu">select</span>(<span class="sc">-</span>area_fips, </span>
<span id="cb4-43"><a href="#cb4-43" aria-hidden="true" tabindex="-1"></a>                       <span class="sc">-</span>industry_code, </span>
<span id="cb4-44"><a href="#cb4-44" aria-hidden="true" tabindex="-1"></a>                       <span class="sc">-</span>annual_avg_emplvl, </span>
<span id="cb4-45"><a href="#cb4-45" aria-hidden="true" tabindex="-1"></a>                       <span class="sc">-</span>total_annual_wages) <span class="sc">|&gt;</span></span>
<span id="cb4-46"><a href="#cb4-46" aria-hidden="true" tabindex="-1"></a>                <span class="co"># 10 is a special value: "all industries" , so omit</span></span>
<span id="cb4-47"><a href="#cb4-47" aria-hidden="true" tabindex="-1"></a>                <span class="fu">filter</span>(INDUSTRY <span class="sc">!=</span> <span class="dv">10</span>) <span class="sc">|&gt;</span> </span>
<span id="cb4-48"><a href="#cb4-48" aria-hidden="true" tabindex="-1"></a>                <span class="fu">mutate</span>(<span class="at">AVG_WAGE =</span> TOTAL_WAGES <span class="sc">/</span> EMPLOYMENT)</span>
<span id="cb4-49"><a href="#cb4-49" aria-hidden="true" tabindex="-1"></a>        })) <span class="sc">|&gt;</span> <span class="fu">bind_rows</span>()</span>
<span id="cb4-50"><a href="#cb4-50" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb4-51"><a href="#cb4-51" aria-hidden="true" tabindex="-1"></a>        <span class="fu">write_csv</span>(ALL_DATA, fname)</span>
<span id="cb4-52"><a href="#cb4-52" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb4-53"><a href="#cb4-53" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb4-54"><a href="#cb4-54" aria-hidden="true" tabindex="-1"></a>    ALL_DATA <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(fname, <span class="at">show_col_types=</span><span class="cn">FALSE</span>)</span>
<span id="cb4-55"><a href="#cb4-55" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb4-56"><a href="#cb4-56" aria-hidden="true" tabindex="-1"></a>    ALL_DATA_YEARS <span class="ot">&lt;-</span> <span class="fu">unique</span>(ALL_DATA<span class="sc">$</span>YEAR)</span>
<span id="cb4-57"><a href="#cb4-57" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb4-58"><a href="#cb4-58" aria-hidden="true" tabindex="-1"></a>    YEARS_DIFF <span class="ot">&lt;-</span> <span class="fu">setdiff</span>(YEARS, ALL_DATA_YEARS)</span>
<span id="cb4-59"><a href="#cb4-59" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb4-60"><a href="#cb4-60" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(<span class="fu">length</span>(YEARS_DIFF) <span class="sc">&gt;</span> <span class="dv">0</span>){</span>
<span id="cb4-61"><a href="#cb4-61" aria-hidden="true" tabindex="-1"></a>        <span class="fu">stop</span>(<span class="st">"Download failed for the following years: "</span>, YEARS_DIFF, </span>
<span id="cb4-62"><a href="#cb4-62" aria-hidden="true" tabindex="-1"></a>             <span class="st">". Please delete intermediate files and try again."</span>)</span>
<span id="cb4-63"><a href="#cb4-63" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb4-64"><a href="#cb4-64" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb4-65"><a href="#cb4-65" aria-hidden="true" tabindex="-1"></a>    ALL_DATA</span>
<span id="cb4-66"><a href="#cb4-66" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb4-67"><a href="#cb4-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-68"><a href="#cb4-68" aria-hidden="true" tabindex="-1"></a>WAGES <span class="ot">&lt;-</span> <span class="fu">get_bls_qcew_annual_averages</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>PERMITS</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5,658 Ã— 3
    CBSA new_housing_units_permitted  year
   &lt;dbl&gt;                       &lt;dbl&gt; &lt;dbl&gt;
 1 10180                         214  2009
 2 10420                         741  2009
 3 10500                         213  2009
 4 10580                        1380  2009
 5 10740                        1692  2009
 6 10780                         396  2009
 7 10900                        1648  2009
 8 11020                         125  2009
 9 11100                         642  2009
10 11180                         122  2009
# â„¹ 5,648 more rows</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>WAGES</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4,442,181 Ã— 6
    YEAR FIPS  INDUSTRY EMPLOYMENT TOTAL_WAGES AVG_WAGE
   &lt;dbl&gt; &lt;chr&gt;    &lt;dbl&gt;      &lt;dbl&gt;       &lt;dbl&gt;    &lt;dbl&gt;
 1  2009 C1018      101       8050   342280951   42519.
 2  2009 C1018     1011       1769    86660038   48988.
 3  2009 C1018     1012       3328   151822573   45620.
 4  2009 C1018     1013       2952   103798340   35162.
 5  2009 C1018      102      42334  1284997543   30354.
 6  2009 C1018     1021      11993   368955371   30764.
 7  2009 C1018     1022          0           0      NA 
 8  2009 C1018     1023       3575   138206437   38659.
 9  2009 C1018     1024       4697   149886226   31911.
10  2009 C1018     1025      11950   452254692   37846.
# â„¹ 4,442,171 more rows</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>INDUSTRY_CODES</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 798 Ã— 8
   level1_title   level2_title level3_title level4_title level1_code level2_code
   &lt;chr&gt;          &lt;chr&gt;        &lt;chr&gt;        &lt;chr&gt;              &lt;dbl&gt;       &lt;dbl&gt;
 1 Agriculture, â€¦ Crop producâ€¦ Oilseed andâ€¦ Soybean farâ€¦          11         111
 2 Agriculture, â€¦ Crop producâ€¦ Oilseed andâ€¦ Oilseed (exâ€¦          11         111
 3 Agriculture, â€¦ Crop producâ€¦ Oilseed andâ€¦ Dry pea andâ€¦          11         111
 4 Agriculture, â€¦ Crop producâ€¦ Oilseed andâ€¦ Wheat farmiâ€¦          11         111
 5 Agriculture, â€¦ Crop producâ€¦ Oilseed andâ€¦ Corn farming          11         111
 6 Agriculture, â€¦ Crop producâ€¦ Oilseed andâ€¦ Rice farming          11         111
 7 Agriculture, â€¦ Crop producâ€¦ Oilseed andâ€¦ Other grainâ€¦          11         111
 8 Agriculture, â€¦ Crop producâ€¦ Vegetable aâ€¦ Vegetable aâ€¦          11         111
 9 Agriculture, â€¦ Crop producâ€¦ Fruit and tâ€¦ Orange grovâ€¦          11         111
10 Agriculture, â€¦ Crop producâ€¦ Fruit and tâ€¦ Citrus (excâ€¦          11         111
# â„¹ 788 more rows
# â„¹ 2 more variables: level3_code &lt;dbl&gt;, level4_code &lt;dbl&gt;</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>INCOME</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 7,279 Ã— 4
   GEOID NAME                                           household_income  year
   &lt;dbl&gt; &lt;chr&gt;                                                     &lt;dbl&gt; &lt;dbl&gt;
 1 10140 Aberdeen, WA Micro Area                                   36345  2009
 2 10180 Abilene, TX Metro Area                                    42931  2009
 3 10300 Adrian, MI Micro Area                                     45640  2009
 4 10380 Aguadilla-Isabela-San Sebasti?n, PR Metro Area            13470  2009
 5 10420 Akron, OH Metro Area                                      47482  2009
 6 10500 Albany, GA Metro Area                                     36218  2009
 7 10540 Albany-Lebanon, OR Micro Area                             47669  2009
 8 10580 Albany-Schenectady-Troy, NY Metro Area                    57677  2009
 9 10700 Albertville, AL Micro Area                                37284  2009
10 10740 Albuquerque, NM Metro Area                                46824  2009
# â„¹ 7,269 more rows</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>RENT</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 7,279 Ã— 4
   GEOID NAME                                           monthly_rent  year
   &lt;dbl&gt; &lt;chr&gt;                                                 &lt;dbl&gt; &lt;dbl&gt;
 1 10140 Aberdeen, WA Micro Area                                 650  2009
 2 10180 Abilene, TX Metro Area                                  712  2009
 3 10300 Adrian, MI Micro Area                                   645  2009
 4 10380 Aguadilla-Isabela-San Sebasti?n, PR Metro Area          363  2009
 5 10420 Akron, OH Metro Area                                    723  2009
 6 10500 Albany, GA Metro Area                                   624  2009
 7 10540 Albany-Lebanon, OR Micro Area                           761  2009
 8 10580 Albany-Schenectady-Troy, NY Metro Area                  833  2009
 9 10700 Albertville, AL Micro Area                              579  2009
10 10740 Albuquerque, NM Metro Area                              726  2009
# â„¹ 7,269 more rows</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>POPULATION</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 7,279 Ã— 4
   GEOID NAME                                           population  year
   &lt;dbl&gt; &lt;chr&gt;                                               &lt;dbl&gt; &lt;dbl&gt;
 1 10140 Aberdeen, WA Micro Area                             71797  2009
 2 10180 Abilene, TX Metro Area                             160266  2009
 3 10300 Adrian, MI Micro Area                               99837  2009
 4 10380 Aguadilla-Isabela-San Sebasti?n, PR Metro Area     342495  2009
 5 10420 Akron, OH Metro Area                               699935  2009
 6 10500 Albany, GA Metro Area                              164238  2009
 7 10540 Albany-Lebanon, OR Micro Area                      116584  2009
 8 10580 Albany-Schenectady-Troy, NY Metro Area             857592  2009
 9 10700 Albertville, AL Micro Area                          90399  2009
10 10740 Albuquerque, NM Metro Area                         856216  2009
# â„¹ 7,269 more rows</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>HOUSEHOLDS</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 7,279 Ã— 4
   GEOID NAME                                           households  year
   &lt;dbl&gt; &lt;chr&gt;                                               &lt;dbl&gt; &lt;dbl&gt;
 1 10140 Aberdeen, WA Micro Area                             27759  2009
 2 10180 Abilene, TX Metro Area                              58052  2009
 3 10300 Adrian, MI Micro Area                               36835  2009
 4 10380 Aguadilla-Isabela-San Sebasti?n, PR Metro Area      91805  2009
 5 10420 Akron, OH Metro Area                               281769  2009
 6 10500 Albany, GA Metro Area                               60101  2009
 7 10540 Albany-Lebanon, OR Micro Area                       43953  2009
 8 10580 Albany-Schenectady-Troy, NY Metro Area             336492  2009
 9 10700 Albertville, AL Micro Area                          32651  2009
10 10740 Albuquerque, NM Metro Area                         334647  2009
# â„¹ 7,269 more rows</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>HOUSEHOLD_INCOMES <span class="ot">&lt;-</span> <span class="fu">left_join</span>(HOUSEHOLDS, INCOME, <span class="fu">join_by</span>(GEOID <span class="sc">==</span> GEOID, year <span class="sc">==</span> year, NAME <span class="sc">==</span> NAME)) <span class="sc">|&gt;</span> <span class="fu">mutate</span>(<span class="at">state =</span> <span class="fu">str_extract</span>(NAME, <span class="st">", (.{2})"</span>, <span class="at">group=</span><span class="dv">1</span>))</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>HOUSEHOLD_INCOMES</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 7,279 Ã— 6
   GEOID NAME                            households  year household_income state
   &lt;dbl&gt; &lt;chr&gt;                                &lt;dbl&gt; &lt;dbl&gt;            &lt;dbl&gt; &lt;chr&gt;
 1 10140 Aberdeen, WA Micro Area              27759  2009            36345 WA   
 2 10180 Abilene, TX Metro Area               58052  2009            42931 TX   
 3 10300 Adrian, MI Micro Area                36835  2009            45640 MI   
 4 10380 Aguadilla-Isabela-San Sebasti?â€¦      91805  2009            13470 PR   
 5 10420 Akron, OH Metro Area                281769  2009            47482 OH   
 6 10500 Albany, GA Metro Area                60101  2009            36218 GA   
 7 10540 Albany-Lebanon, OR Micro Area        43953  2009            47669 OR   
 8 10580 Albany-Schenectady-Troy, NY Meâ€¦     336492  2009            57677 NY   
 9 10700 Albertville, AL Micro Area           32651  2009            37284 AL   
10 10740 Albuquerque, NM Metro Area          334647  2009            46824 NM   
# â„¹ 7,269 more rows</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>HOUSEHOLDS_INCOMES_POPULATION <span class="ot">&lt;-</span> <span class="fu">left_join</span>(HOUSEHOLD_INCOMES, POPULATION, <span class="fu">join_by</span>(GEOID <span class="sc">==</span> GEOID, year <span class="sc">==</span> year, NAME <span class="sc">==</span> NAME))</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>HOUSEHOLDS_INCOMES_POPULATION </span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 7,279 Ã— 7
   GEOID NAME                 households  year household_income state population
   &lt;dbl&gt; &lt;chr&gt;                     &lt;dbl&gt; &lt;dbl&gt;            &lt;dbl&gt; &lt;chr&gt;      &lt;dbl&gt;
 1 10140 Aberdeen, WA Micro â€¦      27759  2009            36345 WA         71797
 2 10180 Abilene, TX Metro Aâ€¦      58052  2009            42931 TX        160266
 3 10300 Adrian, MI Micro Arâ€¦      36835  2009            45640 MI         99837
 4 10380 Aguadilla-Isabela-Sâ€¦      91805  2009            13470 PR        342495
 5 10420 Akron, OH Metro Area     281769  2009            47482 OH        699935
 6 10500 Albany, GA Metro Arâ€¦      60101  2009            36218 GA        164238
 7 10540 Albany-Lebanon, OR â€¦      43953  2009            47669 OR        116584
 8 10580 Albany-Schenectady-â€¦     336492  2009            57677 NY        857592
 9 10700 Albertville, AL Micâ€¦      32651  2009            37284 AL         90399
10 10740 Albuquerque, NM Metâ€¦     334647  2009            46824 NM        856216
# â„¹ 7,269 more rows</code></pre>
</div>
</div>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>CBSA1019 <span class="ot">&lt;-</span> PERMITS <span class="sc">%&gt;%</span></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(year <span class="sc">&gt;=</span> <span class="dv">2010</span> <span class="sc">&amp;</span> year <span class="sc">&lt;=</span> <span class="dv">2019</span>)</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>max_CBSA1019 <span class="ot">&lt;-</span> CBSA1019 <span class="sc">%&gt;%</span></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_max</span>(<span class="at">order_by =</span> new_housing_units_permitted, <span class="at">n =</span> <span class="dv">1</span>, <span class="at">with_ties =</span> <span class="cn">FALSE</span>)</span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>max_CBSA1019_name <span class="ot">&lt;-</span> max_CBSA1019 <span class="sc">%&gt;%</span></span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(CBSA)</span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>max_CBSA1019_name</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 35620</code></pre>
</div>
</div>
<section id="which-cbsa-by-name-permitted-the-largest-number-of-new-housing-units-in-the-decade-from-2010-to-2019-inclusive" class="level3">
<h3 class="anchored" data-anchor-id="which-cbsa-by-name-permitted-the-largest-number-of-new-housing-units-in-the-decade-from-2010-to-2019-inclusive">Which CBSA (by name) permitted the largest number of new housing units in the decade from 2010 to 2019 (inclusive)?</h3>
<p>The CBSA with the most new housing units permitted was 3.562^{4}</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>CBSA10740 <span class="ot">&lt;-</span> PERMITS <span class="sc">%&gt;%</span></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(CBSA <span class="sc">==</span> <span class="dv">10740</span>)</span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>max_perm_10740_year <span class="ot">&lt;-</span> CBSA10740 <span class="sc">%&gt;%</span></span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_max</span>(<span class="at">order_by =</span> new_housing_units_permitted, <span class="at">n =</span> <span class="dv">1</span>, <span class="at">with_ties =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(year)</span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>CBSA10740</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 15 Ã— 3
    CBSA new_housing_units_permitted  year
   &lt;dbl&gt;                       &lt;dbl&gt; &lt;dbl&gt;
 1 10740                        1692  2009
 2 10740                        1764  2010
 3 10740                        1634  2011
 4 10740                        2084  2012
 5 10740                        2606  2013
 6 10740                        2543  2014
 7 10740                        2295  2015
 8 10740                        2465  2016
 9 10740                        2256  2017
10 10740                        2186  2018
11 10740                        2148  2019
12 10740                        2014  2020
13 10740                        4021  2021
14 10740                        2852  2022
15 10740                        2834  2023</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>max_perm_10740_year</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2021</code></pre>
</div>
</div>
</section>
<section id="in-what-year-did-albuquerque-nm-cbsa-number-10740-permit-the-most-new-housing-units" class="level3">
<h3 class="anchored" data-anchor-id="in-what-year-did-albuquerque-nm-cbsa-number-10740-permit-the-most-new-housing-units">In what year did Albuquerque, NM (CBSA Number 10740) permit the most new housing units?</h3>
<p>2021 was the year that Albuquerque, NM (CBSA Number 10740) permited the most housing units.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>HOUSEHOLDS_INCOMES_POPULATION <span class="ot">&lt;-</span> HOUSEHOLDS_INCOMES_POPULATION <span class="sc">%&gt;%</span></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">total_household_income =</span> households <span class="sc">*</span> household_income)</span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>HOUSEHOLDS_INCOMES_POPULATION</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 7,279 Ã— 8
   GEOID NAME                 households  year household_income state population
   &lt;dbl&gt; &lt;chr&gt;                     &lt;dbl&gt; &lt;dbl&gt;            &lt;dbl&gt; &lt;chr&gt;      &lt;dbl&gt;
 1 10140 Aberdeen, WA Micro â€¦      27759  2009            36345 WA         71797
 2 10180 Abilene, TX Metro Aâ€¦      58052  2009            42931 TX        160266
 3 10300 Adrian, MI Micro Arâ€¦      36835  2009            45640 MI         99837
 4 10380 Aguadilla-Isabela-Sâ€¦      91805  2009            13470 PR        342495
 5 10420 Akron, OH Metro Area     281769  2009            47482 OH        699935
 6 10500 Albany, GA Metro Arâ€¦      60101  2009            36218 GA        164238
 7 10540 Albany-Lebanon, OR â€¦      43953  2009            47669 OR        116584
 8 10580 Albany-Schenectady-â€¦     336492  2009            57677 NY        857592
 9 10700 Albertville, AL Micâ€¦      32651  2009            37284 AL         90399
10 10740 Albuquerque, NM Metâ€¦     334647  2009            46824 NM        856216
# â„¹ 7,269 more rows
# â„¹ 1 more variable: total_household_income &lt;dbl&gt;</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>HOUSEHOLDS_INCOMES_POPULATION_STATE <span class="ot">&lt;-</span> HOUSEHOLDS_INCOMES_POPULATION <span class="sc">%&gt;%</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(state, year) <span class="sc">%&gt;%</span></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">total_income =</span> <span class="fu">sum</span>(total_household_income),</span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">total_households =</span> <span class="fu">sum</span>(households),</span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">total_population =</span> <span class="fu">sum</span>(population)</span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a>HOUSEHOLDS_INCOMES_POPULATION_STATE <span class="ot">&lt;-</span> HOUSEHOLDS_INCOMES_POPULATION_STATE <span class="sc">%&gt;%</span></span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">average_income =</span> total_income<span class="sc">/</span>total_population)</span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a>HOUSEHOLDS_INCOMES_POPULATION_STATE</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 728 Ã— 6
# Groups:   state [52]
   state  year total_income total_households total_population average_income
   &lt;chr&gt; &lt;dbl&gt;        &lt;dbl&gt;            &lt;dbl&gt;            &lt;dbl&gt;          &lt;dbl&gt;
 1 AK     2009  11422033506           157987           473213         24137.
 2 AK     2010  11948176005           172733           481278         24826.
 3 AK     2011  12476589020           176995           486708         25635.
 4 AK     2012  12190073504           172996           492807         24736.
 5 AK     2013  12627323155           167773           496578         25429.
 6 AK     2014  12743066658           171141           498249         25576.
 7 AK     2015  13197939163           171076           499421         26426.
 8 AK     2016  13754312022           169324           503162         27336.
 9 AK     2017  13206858098           171862           500591         26383.
10 AK     2018  13885857215           173861           498119         27877.
# â„¹ 718 more rows</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>HOUSEHOLDS_INCOMES_POPULATION_STATE_2015 <span class="ot">&lt;-</span> HOUSEHOLDS_INCOMES_POPULATION_STATE <span class="sc">%&gt;%</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(year <span class="sc">==</span> <span class="dv">2015</span>) </span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>HOUSEHOLDS_INCOMES_POPULATION_STATE_2015</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 52 Ã— 6
# Groups:   state [52]
   state  year total_income total_households total_population average_income
   &lt;chr&gt; &lt;dbl&gt;        &lt;dbl&gt;            &lt;dbl&gt;            &lt;dbl&gt;          &lt;dbl&gt;
 1 AK     2015  13197939163           171076           499421         26426.
 2 AL     2015  71252458302          1488309          3918760         18182.
 3 AR     2015  34776672740           763351          2010218         17300.
 4 AZ     2015 124804732169          2385071          6589624         18940.
 5 CA     2015 845185409868         12727278         38700100         21839.
 6 CO     2015 123095455889          1839486          4840469         25430.
 7 CT     2015  94480626751          1300147          3474313         27194.
 8 DC     2015 202663489140          2172310          6098283         33233.
 9 DE     2015   3547319106            62477           173533         20442.
10 FL     2015 363239584433          7301618         19783678         18361.
# â„¹ 42 more rows</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>MAX_AVG_INC_STATE <span class="ot">&lt;-</span> HOUSEHOLDS_INCOMES_POPULATION_STATE_2015 <span class="sc">%&gt;%</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_max</span>(<span class="at">order_by =</span> average_income, <span class="at">n =</span> <span class="dv">1</span>, <span class="at">with_ties =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(state)</span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>MAX_AVG_INC_STATE</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "DC"</code></pre>
</div>
</div>
</section>
<section id="which-state-not-cbsa-had-the-highest-average-individual-income-in-2015-to-answer-this-question-you-will-need-to-first-compute-the-total-income-per-cbsa-by-multiplying-the-average-household-income-by-the-number-of-households-and-then-sum-total-income-and-total-population-across-all-cbsas-in-a-state.-with-these-numbers-you-can-answer-this-question." class="level3">
<h3 class="anchored" data-anchor-id="which-state-not-cbsa-had-the-highest-average-individual-income-in-2015-to-answer-this-question-you-will-need-to-first-compute-the-total-income-per-cbsa-by-multiplying-the-average-household-income-by-the-number-of-households-and-then-sum-total-income-and-total-population-across-all-cbsas-in-a-state.-with-these-numbers-you-can-answer-this-question.">Which state (not CBSA) had the highest average individual income in 2015? To answer this question, you will need to first compute the total income per CBSA by multiplying the average household income by the number of households, and then sum total income and total population across all CBSAs in a state. With these numbers, you can answer this question.</h3>
<p>The state with the highest average individual income in 2015 was DC.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stringr)</span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>WAGES <span class="ot">&lt;-</span> WAGES <span class="sc">|&gt;</span> <span class="fu">mutate</span>(<span class="at">GEOID =</span> <span class="fu">as.double</span>(<span class="fu">str_remove</span>(FIPS, <span class="st">"^C"</span>))<span class="sc">*</span><span class="dv">10</span>)</span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>c5182_WAGES <span class="ot">&lt;-</span> WAGES <span class="sc">%&gt;%</span></span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(INDUSTRY <span class="sc">==</span> <span class="dv">5182</span>)</span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a>c5182_WAGES_MAX_PER_YEAR <span class="ot">&lt;-</span> c5182_WAGES <span class="sc">%&gt;%</span></span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(YEAR) <span class="sc">%&gt;%</span></span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">max_employment =</span> <span class="fu">max</span>(EMPLOYMENT), <span class="at">.groups =</span> <span class="st">"drop"</span>)</span>
<span id="cb37-10"><a href="#cb37-10" aria-hidden="true" tabindex="-1"></a>NY_MAX <span class="ot">&lt;-</span> WAGES <span class="sc">%&gt;%</span></span>
<span id="cb37-11"><a href="#cb37-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(GEOID <span class="sc">==</span> <span class="dv">35620</span>) <span class="sc">%&gt;%</span></span>
<span id="cb37-12"><a href="#cb37-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(c5182_WAGES_MAX_PER_YEAR, <span class="at">by =</span> <span class="st">"YEAR"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb37-13"><a href="#cb37-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(EMPLOYMENT <span class="sc">==</span> max_employment)</span>
<span id="cb37-14"><a href="#cb37-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-15"><a href="#cb37-15" aria-hidden="true" tabindex="-1"></a>NY_MAX</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 15 Ã— 8
    YEAR FIPS  INDUSTRY EMPLOYMENT TOTAL_WAGES AVG_WAGE GEOID max_employment
   &lt;dbl&gt; &lt;chr&gt;    &lt;dbl&gt;      &lt;dbl&gt;       &lt;dbl&gt;    &lt;dbl&gt; &lt;dbl&gt;          &lt;dbl&gt;
 1  2009 C3562      518      16349  1626754391   99502. 35620          16349
 2  2009 C3562     5182      16349  1626754391   99502. 35620          16349
 3  2009 C3562    51821      16349  1626754391   99502. 35620          16349
 4  2012 C3562      518      14423  1625393597  112695. 35620          14423
 5  2012 C3562     5182      14423  1625393597  112695. 35620          14423
 6  2012 C3562    51821      14423  1625393597  112695. 35620          14423
 7  2013 C3562      518      14251  1619739693  113658. 35620          14251
 8  2013 C3562     5182      14251  1619739693  113658. 35620          14251
 9  2013 C3562    51821      14251  1619739693  113658. 35620          14251
10  2014 C3562      518      17828  2201498626  123485. 35620          17828
11  2014 C3562     5182      17828  2201498626  123485. 35620          17828
12  2014 C3562    51821      17828  2201498626  123485. 35620          17828
13  2015 C3562      518      18922  2751424594  145409. 35620          18922
14  2015 C3562     5182      18922  2751424594  145409. 35620          18922
15  2015 C3562    51821      18922  2751424594  145409. 35620          18922</code></pre>
</div>
</div>
</section>
<section id="data-scientists-and-business-analysts-are-recorded-under-naics-code-5182.-what-is-the-last-year-in-which-the-nyc-cbsa-had-the-most-data-scientists-in-the-country-in-recent-the-san-francisco-cbsa-has-had-the-most-data-scientists." class="level3">
<h3 class="anchored" data-anchor-id="data-scientists-and-business-analysts-are-recorded-under-naics-code-5182.-what-is-the-last-year-in-which-the-nyc-cbsa-had-the-most-data-scientists-in-the-country-in-recent-the-san-francisco-cbsa-has-had-the-most-data-scientists.">Data scientists and business analysts are recorded under NAICS code 5182. What is the last year in which the NYC CBSA had the most data scientists in the country? In recent, the San Francisco CBSA has had the most data scientists.</h3>
<p>The most recent year that the NYC CBSA had the most data scientists in the country was in 2015.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>NY_WAGES <span class="ot">&lt;-</span> WAGES <span class="sc">%&gt;%</span></span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(GEOID <span class="sc">==</span> <span class="dv">35620</span>)</span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>NY_WAGES</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 15,210 Ã— 7
    YEAR FIPS  INDUSTRY EMPLOYMENT  TOTAL_WAGES AVG_WAGE GEOID
   &lt;dbl&gt; &lt;chr&gt;    &lt;dbl&gt;      &lt;dbl&gt;        &lt;dbl&gt;    &lt;dbl&gt; &lt;dbl&gt;
 1  2009 C3562      101     694093  45351432178   65339. 35620
 2  2009 C3562     1011          0            0      NA  35620
 3  2009 C3562     1012     306450  19619006119   64020. 35620
 4  2009 C3562     1013          0            0      NA  35620
 5  2009 C3562      102    6044935 390950505074   64674. 35620
 6  2009 C3562     1021    1480318  68422748758   46222. 35620
 7  2009 C3562     1022     252116  24002664869   95205. 35620
 8  2009 C3562     1023     714531 104952654659  146883. 35620
 9  2009 C3562     1024    1195175  96265810175   80545. 35620
10  2009 C3562     1025    1419237  67013181351   47218. 35620
# â„¹ 15,200 more rows</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>NY_WAGES_52 <span class="ot">&lt;-</span> NY_WAGES <span class="sc">%&gt;%</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(INDUSTRY <span class="sc">==</span> <span class="dv">52</span>)</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>NY_WAGES_52</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 14 Ã— 7
    YEAR FIPS  INDUSTRY EMPLOYMENT  TOTAL_WAGES AVG_WAGE GEOID
   &lt;dbl&gt; &lt;chr&gt;    &lt;dbl&gt;      &lt;dbl&gt;        &lt;dbl&gt;    &lt;dbl&gt; &lt;dbl&gt;
 1  2009 C3562       52     528354  94479998021  178819. 35620
 2  2010 C3562       52     519636 103632250413  199432. 35620
 3  2011 C3562       52     527335 108996581223  206693. 35620
 4  2012 C3562       52     521988 107816036343  206549. 35620
 5  2013 C3562       52     524514 107314017412  204597. 35620
 6  2014 C3562       52     528489 119105615711  225370. 35620
 7  2015 C3562       52     535280 119431006954  223119. 35620
 8  2016 C3562       52     536679 118586163642  220963. 35620
 9  2017 C3562       52     540300 130116071763  240822. 35620
10  2018 C3562       52     544202 128706315380  236505. 35620
11  2019 C3562       52     548324 132713121248  242034. 35620
12  2021 C3562       52     533044 156065553132  292782. 35620
13  2022 C3562       52     540768 159178860174  294357. 35620
14  2023 C3562       52     552105 160765698817  291187. 35620</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>NY_TOTAL_WAGES_52 <span class="ot">&lt;-</span> NY_WAGES_52 <span class="sc">%&gt;%</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">WAGES_52 =</span> <span class="fu">sum</span>(TOTAL_WAGES))</span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>NY_TOTALWAGES_ALL <span class="ot">&lt;-</span> NY_WAGES <span class="sc">%&gt;%</span></span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">WAGES_ALL =</span> <span class="fu">sum</span>(TOTAL_WAGES))</span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a>NY_52_RATIO <span class="ot">&lt;-</span> NY_TOTAL_WAGES_52<span class="sc">/</span>NY_TOTALWAGES_ALL</span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a>NY_52_RATIO <span class="ot">&lt;-</span> NY_52_RATIO <span class="sc">%&gt;%</span></span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(WAGES_52)</span>
<span id="cb43-8"><a href="#cb43-8" aria-hidden="true" tabindex="-1"></a>NY_52_RATIO</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.04086742</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>NY_TOTAL_WAGES <span class="ot">&lt;-</span> NY_WAGES <span class="sc">%&gt;%</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(YEAR) <span class="sc">%&gt;%</span></span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">TOTAL_YEAR_WAGES =</span> <span class="fu">sum</span>(TOTAL_WAGES)</span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a>NY_TOTAL_WAGES</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 14 Ã— 2
    YEAR TOTAL_YEAR_WAGES
   &lt;dbl&gt;            &lt;dbl&gt;
 1  2009    2194200174111
 2  2010    2366455158958
 3  2011    2452875238158
 4  2012    2543568475824
 5  2013    2663041532424
 6  2014    2587096519796
 7  2015    3008221071967
 8  2016    3038312046515
 9  2017    3176952501734
10  2018    3196707717054
11  2019    3617150803059
12  2021    3636399927489
13  2022    4104601808975
14  2023    4160135177511</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>NY_WAGES_RATIO <span class="ot">&lt;-</span> NY_WAGES_52 <span class="sc">%&gt;%</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(NY_TOTAL_WAGES, <span class="fu">join_by</span>(YEAR)) <span class="sc">%&gt;%</span></span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">ratio_52 =</span> TOTAL_WAGES<span class="sc">/</span>TOTAL_YEAR_WAGES,</span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">YEAR =</span> YEAR</span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a>NY_52_PEAK <span class="ot">&lt;-</span> NY_WAGES_RATIO <span class="sc">%&gt;%</span></span>
<span id="cb47-8"><a href="#cb47-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_max</span>(<span class="at">order_by =</span> ratio_52, <span class="at">n =</span> <span class="dv">1</span>, <span class="at">with_ties =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb47-9"><a href="#cb47-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(YEAR)</span>
<span id="cb47-10"><a href="#cb47-10" aria-hidden="true" tabindex="-1"></a>NY_52_PEAK</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2014</code></pre>
</div>
</div>
</section>
<section id="what-fraction-of-total-wages-in-the-nyc-cbsa-was-earned-by-people-employed-in-the-finance-and-insurance-industries-naics-code-52-in-what-year-did-this-fraction-peak" class="level3">
<h3 class="anchored" data-anchor-id="what-fraction-of-total-wages-in-the-nyc-cbsa-was-earned-by-people-employed-in-the-finance-and-insurance-industries-naics-code-52-in-what-year-did-this-fraction-peak">What fraction of total wages in the NYC CBSA was earned by people employed in the finance and insurance industries (NAICS code 52)? In what year did this fraction peak?</h3>
<p>The fraction of total wages earned by NAICS code 52 was 0.0408674. This ratio peaked in 2014.</p>
</section>
<section id="relationship-between-monthly-rent-and-average-household-income-per-cbsa-in-2009" class="level3">
<h3 class="anchored" data-anchor-id="relationship-between-monthly-rent-and-average-household-income-per-cbsa-in-2009">Relationship between monthly rent and average household income per CBSA in 2009</h3>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>RENT</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 7,279 Ã— 4
   GEOID NAME                                           monthly_rent  year
   &lt;dbl&gt; &lt;chr&gt;                                                 &lt;dbl&gt; &lt;dbl&gt;
 1 10140 Aberdeen, WA Micro Area                                 650  2009
 2 10180 Abilene, TX Metro Area                                  712  2009
 3 10300 Adrian, MI Micro Area                                   645  2009
 4 10380 Aguadilla-Isabela-San Sebasti?n, PR Metro Area          363  2009
 5 10420 Akron, OH Metro Area                                    723  2009
 6 10500 Albany, GA Metro Area                                   624  2009
 7 10540 Albany-Lebanon, OR Micro Area                           761  2009
 8 10580 Albany-Schenectady-Troy, NY Metro Area                  833  2009
 9 10700 Albertville, AL Micro Area                              579  2009
10 10740 Albuquerque, NM Metro Area                              726  2009
# â„¹ 7,269 more rows</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>INCOME</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 7,279 Ã— 4
   GEOID NAME                                           household_income  year
   &lt;dbl&gt; &lt;chr&gt;                                                     &lt;dbl&gt; &lt;dbl&gt;
 1 10140 Aberdeen, WA Micro Area                                   36345  2009
 2 10180 Abilene, TX Metro Area                                    42931  2009
 3 10300 Adrian, MI Micro Area                                     45640  2009
 4 10380 Aguadilla-Isabela-San Sebasti?n, PR Metro Area            13470  2009
 5 10420 Akron, OH Metro Area                                      47482  2009
 6 10500 Albany, GA Metro Area                                     36218  2009
 7 10540 Albany-Lebanon, OR Micro Area                             47669  2009
 8 10580 Albany-Schenectady-Troy, NY Metro Area                    57677  2009
 9 10700 Albertville, AL Micro Area                                37284  2009
10 10740 Albuquerque, NM Metro Area                                46824  2009
# â„¹ 7,269 more rows</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>RENT_INCOME <span class="ot">&lt;-</span> RENT <span class="sc">%&gt;%</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(INCOME, <span class="fu">join_by</span>(GEOID <span class="sc">==</span> GEOID, NAME <span class="sc">==</span> NAME, year <span class="sc">==</span> year))</span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>RENT_INCOME_2009 <span class="ot">&lt;-</span> RENT_INCOME <span class="sc">%&gt;%</span></span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(year <span class="sc">==</span> <span class="dv">2009</span>)</span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a>RENT_INCOME_2009</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 517 Ã— 5
   GEOID NAME                                monthly_rent  year household_income
   &lt;dbl&gt; &lt;chr&gt;                                      &lt;dbl&gt; &lt;dbl&gt;            &lt;dbl&gt;
 1 10140 Aberdeen, WA Micro Area                      650  2009            36345
 2 10180 Abilene, TX Metro Area                       712  2009            42931
 3 10300 Adrian, MI Micro Area                        645  2009            45640
 4 10380 Aguadilla-Isabela-San Sebasti?n, Pâ€¦          363  2009            13470
 5 10420 Akron, OH Metro Area                         723  2009            47482
 6 10500 Albany, GA Metro Area                        624  2009            36218
 7 10540 Albany-Lebanon, OR Micro Area                761  2009            47669
 8 10580 Albany-Schenectady-Troy, NY Metro â€¦          833  2009            57677
 9 10700 Albertville, AL Micro Area                   579  2009            37284
10 10740 Albuquerque, NM Metro Area                   726  2009            46824
# â„¹ 507 more rows</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(RENT_INCOME_2009, <span class="fu">aes</span>(<span class="at">x =</span> monthly_rent, <span class="at">y =</span> household_income)) <span class="sc">+</span> </span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha=</span><span class="fl">0.3</span>) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Average Household Income vs. Monthly Rent"</span>) <span class="sc">+</span></span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Monthly Rent"</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">"Average Household INcome"</span>) <span class="sc">+</span></span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_smooth</span>(<span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">color =</span> <span class="st">"red4"</span>) <span class="sc">+</span> <span class="fu">scale_x_continuous</span>(<span class="at">labels=</span>scales<span class="sc">::</span>dollar) <span class="sc">+</span></span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels=</span>scales<span class="sc">::</span>dollar) <span class="sc">+</span> <span class="fu">theme_bw</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="mp02_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="the-relationship-between-total-employment-and-total-employment-in-the-health-care-and-social-services-sector-naics-62-across-different-cbsas.-design-your-visualization-so-that-it-is-possible-to-see-the-evolution-of-this-relationship-over-time." class="level3">
<h3 class="anchored" data-anchor-id="the-relationship-between-total-employment-and-total-employment-in-the-health-care-and-social-services-sector-naics-62-across-different-cbsas.-design-your-visualization-so-that-it-is-possible-to-see-the-evolution-of-this-relationship-over-time.">The relationship between total employment and total employment in the health care and social services sector (NAICS 62) across different CBSAs. Design your visualization so that it is possible to see the evolution of this relationship over time.</h3>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a>WAGES</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4,442,181 Ã— 7
    YEAR FIPS  INDUSTRY EMPLOYMENT TOTAL_WAGES AVG_WAGE GEOID
   &lt;dbl&gt; &lt;chr&gt;    &lt;dbl&gt;      &lt;dbl&gt;       &lt;dbl&gt;    &lt;dbl&gt; &lt;dbl&gt;
 1  2009 C1018      101       8050   342280951   42519. 10180
 2  2009 C1018     1011       1769    86660038   48988. 10180
 3  2009 C1018     1012       3328   151822573   45620. 10180
 4  2009 C1018     1013       2952   103798340   35162. 10180
 5  2009 C1018      102      42334  1284997543   30354. 10180
 6  2009 C1018     1021      11993   368955371   30764. 10180
 7  2009 C1018     1022          0           0      NA  10180
 8  2009 C1018     1023       3575   138206437   38659. 10180
 9  2009 C1018     1024       4697   149886226   31911. 10180
10  2009 C1018     1025      11950   452254692   37846. 10180
# â„¹ 4,442,171 more rows</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>WAGES_62 <span class="ot">&lt;-</span> WAGES <span class="sc">%&gt;%</span></span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(INDUSTRY <span class="sc">==</span> <span class="dv">62</span>)</span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>EMPLOYMENT_62 <span class="ot">&lt;-</span> WAGES_62 <span class="sc">%&gt;%</span></span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(GEOID, YEAR) <span class="sc">%&gt;%</span></span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb58-6"><a href="#cb58-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">TOTAL_EMPLOYMENT =</span> <span class="fu">sum</span>(EMPLOYMENT)</span>
<span id="cb58-7"><a href="#cb58-7" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb58-8"><a href="#cb58-8" aria-hidden="true" tabindex="-1"></a>EMPLOYMENT_62</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5,356 Ã— 3
# Groups:   GEOID [405]
   GEOID  YEAR TOTAL_EMPLOYMENT
   &lt;dbl&gt; &lt;dbl&gt;            &lt;dbl&gt;
 1 10180  2009             9881
 2 10180  2010             9926
 3 10180  2011             9780
 4 10180  2012                0
 5 10180  2013            10114
 6 10180  2014            10159
 7 10180  2015            10319
 8 10180  2016            10625
 9 10180  2017            11009
10 10180  2018            11378
# â„¹ 5,346 more rows</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>EMPLOYMENT_YOY <span class="ot">&lt;-</span> WAGES <span class="sc">%&gt;%</span></span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(GEOID, YEAR) <span class="sc">%&gt;%</span></span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">TOTAL_EMPLOYMENT =</span> <span class="fu">sum</span>(EMPLOYMENT)</span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb60-6"><a href="#cb60-6" aria-hidden="true" tabindex="-1"></a>EMPLOYMENT_YOY</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5,356 Ã— 3
# Groups:   GEOID [405]
   GEOID  YEAR TOTAL_EMPLOYMENT
   &lt;dbl&gt; &lt;dbl&gt;            &lt;dbl&gt;
 1 10180  2009           208857
 2 10180  2010           198830
 3 10180  2011           204443
 4 10180  2012           187527
 5 10180  2013           216491
 6 10180  2014           218581
 7 10180  2015           220868
 8 10180  2016           219919
 9 10180  2017           211020
10 10180  2018           219185
# â„¹ 5,346 more rows</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>EMPLOYMENT_RATIO_62 <span class="ot">&lt;-</span> EMPLOYMENT_YOY <span class="sc">%&gt;%</span></span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(EMPLOYMENT_62, <span class="fu">join_by</span>(YEAR <span class="sc">==</span> YEAR, GEOID <span class="sc">==</span> GEOID)) <span class="sc">%&gt;%</span></span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">EMPLOYMENT_RATIO =</span> TOTAL_EMPLOYMENT.y<span class="sc">/</span>TOTAL_EMPLOYMENT.x)</span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-5"><a href="#cb62-5" aria-hidden="true" tabindex="-1"></a>EMPLOYMENT_RATIO_62</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5,356 Ã— 5
# Groups:   GEOID [405]
   GEOID  YEAR TOTAL_EMPLOYMENT.x TOTAL_EMPLOYMENT.y EMPLOYMENT_RATIO
   &lt;dbl&gt; &lt;dbl&gt;              &lt;dbl&gt;              &lt;dbl&gt;            &lt;dbl&gt;
 1 10180  2009             208857               9881           0.0473
 2 10180  2010             198830               9926           0.0499
 3 10180  2011             204443               9780           0.0478
 4 10180  2012             187527                  0           0     
 5 10180  2013             216491              10114           0.0467
 6 10180  2014             218581              10159           0.0465
 7 10180  2015             220868              10319           0.0467
 8 10180  2016             219919              10625           0.0483
 9 10180  2017             211020              11009           0.0522
10 10180  2018             219185              11378           0.0519
# â„¹ 5,346 more rows</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(EMPLOYMENT_RATIO_62, <span class="fu">aes</span>(<span class="at">x =</span> TOTAL_EMPLOYMENT.x, <span class="at">y =</span> TOTAL_EMPLOYMENT.y, )) <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color =</span> YEAR), <span class="at">alpha =</span> .<span class="dv">7</span>, <span class="at">size =</span> <span class="dv">1</span>, <span class="at">position =</span> <span class="fu">position_jitter</span>(<span class="at">width =</span> <span class="fl">0.1</span>, <span class="at">height =</span> <span class="fl">0.1</span>)) <span class="sc">+</span> <span class="fu">scale_color_viridis_c</span>(<span class="at">option =</span> <span class="st">"magma"</span>) <span class="sc">+</span> </span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_log10</span>() <span class="sc">+</span> <span class="fu">scale_y_log10</span>() <span class="sc">+</span></span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">color =</span> <span class="st">"red4"</span>) <span class="sc">+</span></span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb64-5"><a href="#cb64-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Relationship Between Total and Health Care Employment Over Time"</span>,</span>
<span id="cb64-6"><a href="#cb64-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Total Employment"</span>,</span>
<span id="cb64-7"><a href="#cb64-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Health Care and Social Service Employment"</span></span>
<span id="cb64-8"><a href="#cb64-8" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="mp02_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="the-evolution-of-average-household-size-over-time.-use-different-lines-to-represent-different-cbsas." class="level3">
<h3 class="anchored" data-anchor-id="the-evolution-of-average-household-size-over-time.-use-different-lines-to-represent-different-cbsas.">The evolution of average household size over time. Use different lines to represent different CBSAs.</h3>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a>HOUSEHOLDS_INCOMES_POPULATION <span class="ot">&lt;-</span> HOUSEHOLDS_INCOMES_POPULATION <span class="sc">%&gt;%</span></span>
<span id="cb65-5"><a href="#cb65-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">household_size =</span> population<span class="sc">/</span>households)</span>
<span id="cb65-6"><a href="#cb65-6" aria-hidden="true" tabindex="-1"></a>HOUSEHOLDS_INCOMES_POPULATION</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 7,279 Ã— 9
   GEOID NAME                 households  year household_income state population
   &lt;dbl&gt; &lt;chr&gt;                     &lt;dbl&gt; &lt;dbl&gt;            &lt;dbl&gt; &lt;chr&gt;      &lt;dbl&gt;
 1 10140 Aberdeen, WA Micro â€¦      27759  2009            36345 WA         71797
 2 10180 Abilene, TX Metro Aâ€¦      58052  2009            42931 TX        160266
 3 10300 Adrian, MI Micro Arâ€¦      36835  2009            45640 MI         99837
 4 10380 Aguadilla-Isabela-Sâ€¦      91805  2009            13470 PR        342495
 5 10420 Akron, OH Metro Area     281769  2009            47482 OH        699935
 6 10500 Albany, GA Metro Arâ€¦      60101  2009            36218 GA        164238
 7 10540 Albany-Lebanon, OR â€¦      43953  2009            47669 OR        116584
 8 10580 Albany-Schenectady-â€¦     336492  2009            57677 NY        857592
 9 10700 Albertville, AL Micâ€¦      32651  2009            37284 AL         90399
10 10740 Albuquerque, NM Metâ€¦     334647  2009            46824 NM        856216
# â„¹ 7,269 more rows
# â„¹ 2 more variables: total_household_income &lt;dbl&gt;, household_size &lt;dbl&gt;</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(HOUSEHOLDS_INCOMES_POPULATION, <span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> household_size, <span class="at">color =</span> GEOID, <span class="at">group =</span> GEOID )) <span class="sc">+</span> <span class="fu">geom_line</span>(<span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">1.5</span>) <span class="sc">+</span> <span class="fu">scale_y_continuous</span>(</span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="fl">4.6</span>),</span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">2</span>, <span class="fl">4.6</span>, <span class="fl">0.2</span>) ) <span class="sc">+</span> </span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb67-5"><a href="#cb67-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Evolution of Average Household Size Over Time"</span>,</span>
<span id="cb67-6"><a href="#cb67-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Year"</span>,</span>
<span id="cb67-7"><a href="#cb67-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Average Household Size"</span>,</span>
<span id="cb67-8"><a href="#cb67-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"GEOID"</span></span>
<span id="cb67-9"><a href="#cb67-9" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span> <span class="fu">scale_color_viridis_c</span>(<span class="at">option =</span> <span class="st">"magma"</span>) <span class="sc">+</span> <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb67-10"><a href="#cb67-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb67-11"><a href="#cb67-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.border =</span> <span class="fu">element_rect</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">fill =</span> <span class="cn">NA</span>, <span class="at">linewidth =</span> <span class="fl">0.8</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="mp02_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(DT)</span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stringr)</span>
<span id="cb68-5"><a href="#cb68-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-6"><a href="#cb68-6" aria-hidden="true" tabindex="-1"></a>RENT_INCOME <span class="ot">&lt;-</span> RENT_INCOME <span class="sc">%&gt;%</span></span>
<span id="cb68-7"><a href="#cb68-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">yearly_rent_burden_ratio =</span> (monthly_rent<span class="sc">*</span><span class="dv">12</span>)<span class="sc">/</span>household_income,</span>
<span id="cb68-8"><a href="#cb68-8" aria-hidden="true" tabindex="-1"></a>         <span class="at">rent_burden_scaled =</span> (yearly_rent_burden_ratio <span class="sc">-</span> <span class="fu">min</span>(yearly_rent_burden_ratio)) <span class="sc">/</span> </span>
<span id="cb68-9"><a href="#cb68-9" aria-hidden="true" tabindex="-1"></a>                         (<span class="fu">max</span>(yearly_rent_burden_ratio) <span class="sc">-</span> <span class="fu">min</span>(yearly_rent_burden_ratio)) <span class="sc">*</span> <span class="dv">100</span>)</span>
<span id="cb68-10"><a href="#cb68-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-11"><a href="#cb68-11" aria-hidden="true" tabindex="-1"></a>format_titles <span class="ot">&lt;-</span> <span class="cf">function</span>(df){</span>
<span id="cb68-12"><a href="#cb68-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colnames</span>(df) <span class="ot">&lt;-</span> <span class="fu">str_replace_all</span>(<span class="fu">colnames</span>(df), <span class="st">"_"</span>, <span class="st">" "</span>) <span class="sc">|&gt;</span> <span class="fu">str_to_title</span>()</span>
<span id="cb68-13"><a href="#cb68-13" aria-hidden="true" tabindex="-1"></a>    df</span>
<span id="cb68-14"><a href="#cb68-14" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb68-15"><a href="#cb68-15" aria-hidden="true" tabindex="-1"></a>NY_RENT_INCOME <span class="ot">&lt;-</span> RENT_INCOME <span class="sc">%&gt;%</span></span>
<span id="cb68-16"><a href="#cb68-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(GEOID <span class="sc">==</span> <span class="dv">35620</span>)</span>
<span id="cb68-17"><a href="#cb68-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-18"><a href="#cb68-18" aria-hidden="true" tabindex="-1"></a>NY_RENT_INCOME <span class="sc">|&gt;</span> </span>
<span id="cb68-19"><a href="#cb68-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">format_titles</span>() <span class="sc">|&gt;</span></span>
<span id="cb68-20"><a href="#cb68-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">head</span>(<span class="at">n=</span><span class="dv">20</span>) <span class="sc">|&gt;</span></span>
<span id="cb68-21"><a href="#cb68-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">datatable</span>(<span class="at">options=</span><span class="fu">list</span>(<span class="at">searching=</span><span class="cn">FALSE</span>, <span class="at">info=</span><span class="cn">FALSE</span>)) <span class="sc">|&gt;</span></span>
<span id="cb68-22"><a href="#cb68-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">formatRound</span>(<span class="fu">c</span>(<span class="st">'Yearly Rent Burden Ratio'</span>, <span class="st">'Rent Burden Scaled'</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div class="datatables html-widget html-fill-item" id="htmlwidget-6066352d914e85343b31" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-6066352d914e85343b31">{"x":{"filter":"none","vertical":false,"data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14"],[35620,35620,35620,35620,35620,35620,35620,35620,35620,35620,35620,35620,35620,35620],["New York-Northern New Jersey-Long Island, NY-NJ-PA Metro Area","New York-Northern New Jersey-Long Island, NY-NJ-PA Metro Area","New York-Northern New Jersey-Long Island, NY-NJ-PA Metro Area","New York-Northern New Jersey-Long Island, NY-NJ-PA Metro Area","New York-Newark-Jersey City, NY-NJ-PA Metro Area","New York-Newark-Jersey City, NY-NJ-PA Metro Area","New York-Newark-Jersey City, NY-NJ-PA Metro Area","New York-Newark-Jersey City, NY-NJ-PA Metro Area","New York-Newark-Jersey City, NY-NJ-PA Metro Area","New York-Newark-Jersey City, NY-NJ-PA Metro Area","New York-Newark-Jersey City, NY-NJ-PA Metro Area","New York-Newark-Jersey City, NY-NJ-PA Metro Area","New York-Newark-Jersey City, NY-NJ-PA Metro Area","New York-Newark-Jersey City, NY-NJ Metro Area"],[1125,1150,1187,1209,1237,1281,1308,1346,1379,1434,1482,1600,1685,1764],[2009,2010,2011,2012,2013,2014,2015,2016,2017,2018,2019,2021,2022,2023],[62887,61927,62322,63982,65786,67066,68743,71897,75368,78478,83160,84409,91562,95220],[0.2146707586623627,0.2228430248518417,0.2285549244247617,0.226751273795755,0.2256407138296902,0.2292070497718665,0.228328702558806,0.2246547143830758,0.2195626791211124,0.2192716430082316,0.2138528138528139,0.2274638960300442,0.2208339704244119,0.2223062381852552],[35.37090174586488,38.52847000739394,40.73541143420564,40.03852395538485,39.60943013733403,40.98737707639282,40.64800471403232,39.22846352582999,37.26102284818027,37.14857345266569,35.05486742803529,40.31386414833502,37.75221941194666,38.32106847367891]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>Geoid<\/th>\n      <th>Name<\/th>\n      <th>Monthly Rent<\/th>\n      <th>Year<\/th>\n      <th>Household Income<\/th>\n      <th>Yearly Rent Burden Ratio<\/th>\n      <th>Rent Burden Scaled<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"searching":false,"info":false,"columnDefs":[{"targets":6,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 2, 3, \",\", \".\", null);\n  }"},{"targets":7,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 2, 3, \",\", \".\", null);\n  }"},{"className":"dt-right","targets":[1,3,4,5,6,7]},{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"Geoid","targets":1},{"name":"Name","targets":2},{"name":"Monthly Rent","targets":3},{"name":"Year","targets":4},{"name":"Household Income","targets":5},{"name":"Yearly Rent Burden Ratio","targets":6},{"name":"Rent Burden Scaled","targets":7}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":["options.columnDefs.0.render","options.columnDefs.1.render"],"jsHooks":[]}</script>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(NY_RENT_INCOME, <span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> rent_burden_scaled)) <span class="sc">+</span> <span class="fu">geom_line</span>(<span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">1.5</span>) <span class="sc">+</span> <span class="fu">scale_y_continuous</span>(</span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">30</span>, <span class="dv">45</span>),</span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">30</span>, <span class="dv">45</span>, <span class="dv">1</span>) ) <span class="sc">+</span> </span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb69-5"><a href="#cb69-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"NY Rent Burden Scaled Over Time"</span>,</span>
<span id="cb69-6"><a href="#cb69-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Year"</span>,</span>
<span id="cb69-7"><a href="#cb69-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Rent Burden Scaled"</span>,</span>
<span id="cb69-8"><a href="#cb69-8" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="mp02_files/figure-html/unnamed-chunk-14-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a>TOP10_RENT_INCOME <span class="ot">&lt;-</span> RENT_INCOME <span class="sc">%&gt;%</span></span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_max</span>(<span class="at">order_by =</span> rent_burden_scaled, <span class="at">n =</span> <span class="dv">10</span>, <span class="at">with_ties =</span> <span class="cn">FALSE</span>)</span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a>BOT10_RENT_INCOME <span class="ot">&lt;-</span> RENT_INCOME <span class="sc">%&gt;%</span></span>
<span id="cb70-5"><a href="#cb70-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_min</span>(<span class="at">order_by =</span> rent_burden_scaled, <span class="at">n =</span> <span class="dv">10</span>, <span class="at">with_ties =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb70-6"><a href="#cb70-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(rent_burden_scaled))</span>
<span id="cb70-7"><a href="#cb70-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-8"><a href="#cb70-8" aria-hidden="true" tabindex="-1"></a>TOP10_BOT10_RENT_INCOME <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(TOP10_RENT_INCOME, BOT10_RENT_INCOME)</span>
<span id="cb70-9"><a href="#cb70-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-10"><a href="#cb70-10" aria-hidden="true" tabindex="-1"></a>TOP10_BOT10_RENT_INCOME <span class="sc">|&gt;</span></span>
<span id="cb70-11"><a href="#cb70-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">format_titles</span>() <span class="sc">|&gt;</span></span>
<span id="cb70-12"><a href="#cb70-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">head</span>(<span class="at">n=</span><span class="dv">20</span>) <span class="sc">|&gt;</span></span>
<span id="cb70-13"><a href="#cb70-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">datatable</span>(<span class="at">options=</span><span class="fu">list</span>(<span class="at">searching=</span><span class="cn">FALSE</span>, <span class="at">info=</span><span class="cn">FALSE</span>)) <span class="sc">|&gt;</span></span>
<span id="cb70-14"><a href="#cb70-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">formatRound</span>(<span class="fu">c</span>(<span class="st">'Yearly Rent Burden Ratio'</span>, <span class="st">'Rent Burden Scaled'</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div class="datatables html-widget html-fill-item" id="htmlwidget-3b196e8503eaaf733a5c" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-3b196e8503eaaf733a5c">{"x":{"filter":"none","vertical":false,"data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20"],[32420,41900,25020,41900,25020,17620,41900,25020,32420,38660,27600,13900,20180,47700,24260,29060,27620,27600,27620,13900],["MayagÃ¼ez, PR Metro Area","San GermÃ¡n, PR Metro Area","Guayama, PR Metro Area","San Germ?n-Cabo Rojo, PR Metro Area","Guayama, PR Metro Area","Coamo, PR Micro Area","San GermÃ¡n, PR Metro Area","Guayama, PR Metro Area","MayagÃ¼ez, PR Metro Area","Ponce, PR Metro Area","Jefferson, GA Micro Area","Bismarck, ND Metro Area","DuBois, PA Micro Area","Warsaw, IN Micro Area","Grand Island, NE Metro Area","Laconia, NH Micro Area","Jefferson City, MO Metro Area","Jefferson, GA Micro Area","Jefferson City, MO Metro Area","Bismarck, ND Metro Area"],[411,421,458,416,355,375,414,396,432,522,718,575,647,688,643,1037,636,770,672,572],[2018,2014,2012,2010,2013,2009,2017,2014,2017,2022,2017,2010,2022,2019,2017,2023,2018,2018,2021,2009],[12913,13566,14879,14383,12365,13126,14719,14187,15575,18843,66557,53403,60228,64099,60116,97692,60281,73150,63942,55748],[0.3819406799349493,0.3724015922158337,0.3693796626117347,0.3470764096502816,0.3445208249090174,0.3428310223982934,0.3375229295468442,0.3349545358426729,0.3328410914927769,0.3324311415379717,0.1294529501029193,0.1292062243694174,0.1289101414624427,0.1288007613223295,0.1283518530840375,0.1273799287556811,0.1266070569499511,0.1263157894736842,0.1261142910762879,0.1231254932912391],[100,96.31432457931949,95.14672323285789,86.52927954623368,85.54186270473964,84.88896341678166,82.8380432523647,81.84567733385813,81.02909296827167,80.87069810739762,2.44477802625649,2.349449101898781,2.235049745812188,2.192787874887359,2.019340464743699,1.643812142406744,1.345192955583668,1.232654166788477,1.154800003742891,0]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>Geoid<\/th>\n      <th>Name<\/th>\n      <th>Monthly Rent<\/th>\n      <th>Year<\/th>\n      <th>Household Income<\/th>\n      <th>Yearly Rent Burden Ratio<\/th>\n      <th>Rent Burden Scaled<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"searching":false,"info":false,"columnDefs":[{"targets":6,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 2, 3, \",\", \".\", null);\n  }"},{"targets":7,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 2, 3, \",\", \".\", null);\n  }"},{"className":"dt-right","targets":[1,3,4,5,6,7]},{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"Geoid","targets":1},{"name":"Name","targets":2},{"name":"Monthly Rent","targets":3},{"name":"Year","targets":4},{"name":"Household Income","targets":5},{"name":"Yearly Rent Burden Ratio","targets":6},{"name":"Rent Burden Scaled","targets":7}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":["options.columnDefs.0.render","options.columnDefs.1.render"],"jsHooks":[]}</script>
</div>
</div>
</section>
<section id="section" class="level3">
<h3 class="anchored" data-anchor-id="section"></h3>
<ol type="1">
<li>An â€˜instantaneousâ€™ measure of housing growth that depends on the absolute population of a CBSA and the number of new housing units permitted that year.</li>
<li>A â€˜rate-basedâ€™ measure of housing growth that compares the number of housing permits to the population growth over a 5 year lookback window.</li>
</ol>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stringr)</span>
<span id="cb71-4"><a href="#cb71-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(DT)</span>
<span id="cb71-5"><a href="#cb71-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-6"><a href="#cb71-6" aria-hidden="true" tabindex="-1"></a>POPULATION</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 7,279 Ã— 4
   GEOID NAME                                           population  year
   &lt;dbl&gt; &lt;chr&gt;                                               &lt;dbl&gt; &lt;dbl&gt;
 1 10140 Aberdeen, WA Micro Area                             71797  2009
 2 10180 Abilene, TX Metro Area                             160266  2009
 3 10300 Adrian, MI Micro Area                               99837  2009
 4 10380 Aguadilla-Isabela-San Sebasti?n, PR Metro Area     342495  2009
 5 10420 Akron, OH Metro Area                               699935  2009
 6 10500 Albany, GA Metro Area                              164238  2009
 7 10540 Albany-Lebanon, OR Micro Area                      116584  2009
 8 10580 Albany-Schenectady-Troy, NY Metro Area             857592  2009
 9 10700 Albertville, AL Micro Area                          90399  2009
10 10740 Albuquerque, NM Metro Area                         856216  2009
# â„¹ 7,269 more rows</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a>PERMITS</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5,658 Ã— 3
    CBSA new_housing_units_permitted  year
   &lt;dbl&gt;                       &lt;dbl&gt; &lt;dbl&gt;
 1 10180                         214  2009
 2 10420                         741  2009
 3 10500                         213  2009
 4 10580                        1380  2009
 5 10740                        1692  2009
 6 10780                         396  2009
 7 10900                        1648  2009
 8 11020                         125  2009
 9 11100                         642  2009
10 11180                         122  2009
# â„¹ 5,648 more rows</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a>HOUSING_GROWTH <span class="ot">&lt;-</span> POPULATION <span class="sc">%&gt;%</span></span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(PERMITS, <span class="fu">join_by</span>(year <span class="sc">==</span> year, GEOID <span class="sc">==</span> CBSA))</span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-4"><a href="#cb75-4" aria-hidden="true" tabindex="-1"></a>HOUSING_GROWTH <span class="ot">&lt;-</span> HOUSING_GROWTH <span class="sc">%&gt;%</span></span>
<span id="cb75-5"><a href="#cb75-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(GEOID) <span class="sc">%&gt;%</span>                   </span>
<span id="cb75-6"><a href="#cb75-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(year) <span class="sc">%&gt;%</span>                       </span>
<span id="cb75-7"><a href="#cb75-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb75-8"><a href="#cb75-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">pop_lag5 =</span> <span class="fu">lag</span>(population, <span class="dv">5</span>),        </span>
<span id="cb75-9"><a href="#cb75-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">pop_growth_5yr =</span> (population <span class="sc">-</span> pop_lag5) <span class="sc">/</span> pop_lag5 <span class="sc">*</span> <span class="dv">100</span>,</span>
<span id="cb75-10"><a href="#cb75-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">housing_growth_rate =</span> new_housing_units_permitted <span class="sc">/</span> pop_growth_5yr,</span>
<span id="cb75-11"><a href="#cb75-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">rate_scaled =</span> (housing_growth_rate <span class="sc">-</span> <span class="fu">min</span>(housing_growth_rate, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">/</span></span>
<span id="cb75-12"><a href="#cb75-12" aria-hidden="true" tabindex="-1"></a>                  (<span class="fu">max</span>(housing_growth_rate, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">-</span> <span class="fu">min</span>(housing_growth_rate, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">*</span> <span class="dv">100</span></span>
<span id="cb75-13"><a href="#cb75-13" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb75-14"><a href="#cb75-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb75-15"><a href="#cb75-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>pop_lag5)</span>
<span id="cb75-16"><a href="#cb75-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-17"><a href="#cb75-17" aria-hidden="true" tabindex="-1"></a>HOUSING_GROWTH <span class="ot">&lt;-</span> HOUSING_GROWTH <span class="sc">%&gt;%</span></span>
<span id="cb75-18"><a href="#cb75-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb75-19"><a href="#cb75-19" aria-hidden="true" tabindex="-1"></a>  <span class="at">housing_growth_instant =</span> new_housing_units_permitted <span class="sc">/</span> population,</span>
<span id="cb75-20"><a href="#cb75-20" aria-hidden="true" tabindex="-1"></a>  <span class="at">instant_scaled =</span> (housing_growth_instant <span class="sc">-</span> <span class="fu">min</span>(housing_growth_instant, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">/</span></span>
<span id="cb75-21"><a href="#cb75-21" aria-hidden="true" tabindex="-1"></a>                     (<span class="fu">max</span>(housing_growth_instant, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">-</span> <span class="fu">min</span>(housing_growth_instant, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">*</span> <span class="dv">100</span>)</span>
<span id="cb75-22"><a href="#cb75-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-23"><a href="#cb75-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-24"><a href="#cb75-24" aria-hidden="true" tabindex="-1"></a>TOP20_GROWTH_INST <span class="ot">&lt;-</span> HOUSING_GROWTH <span class="sc">%&gt;%</span></span>
<span id="cb75-25"><a href="#cb75-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_max</span>(<span class="at">order_by =</span> instant_scaled, <span class="at">n =</span> <span class="dv">20</span>, <span class="at">with_ties =</span> <span class="cn">FALSE</span>)</span>
<span id="cb75-26"><a href="#cb75-26" aria-hidden="true" tabindex="-1"></a>BOT20_GROWTH_INST <span class="ot">&lt;-</span> HOUSING_GROWTH <span class="sc">%&gt;%</span></span>
<span id="cb75-27"><a href="#cb75-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_min</span>(<span class="at">order_by =</span> instant_scaled, <span class="at">n =</span> <span class="dv">20</span>, <span class="at">with_ties =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb75-28"><a href="#cb75-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(instant_scaled))</span>
<span id="cb75-29"><a href="#cb75-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-30"><a href="#cb75-30" aria-hidden="true" tabindex="-1"></a>TOP20_GROWTH_5YR <span class="ot">&lt;-</span> HOUSING_GROWTH <span class="sc">%&gt;%</span></span>
<span id="cb75-31"><a href="#cb75-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_max</span>(<span class="at">order_by =</span> rate_scaled, <span class="at">n =</span> <span class="dv">20</span>, <span class="at">with_ties =</span> <span class="cn">FALSE</span>)</span>
<span id="cb75-32"><a href="#cb75-32" aria-hidden="true" tabindex="-1"></a>BOT20_GROWTH_5YR <span class="ot">&lt;-</span> HOUSING_GROWTH <span class="sc">%&gt;%</span></span>
<span id="cb75-33"><a href="#cb75-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_min</span>(<span class="at">order_by =</span> rate_scaled, <span class="at">n =</span> <span class="dv">20</span>, <span class="at">with_ties =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb75-34"><a href="#cb75-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(rate_scaled))</span>
<span id="cb75-35"><a href="#cb75-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-36"><a href="#cb75-36" aria-hidden="true" tabindex="-1"></a>TOP20_BOT20_GROWTH_5YR <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(TOP20_GROWTH_5YR, BOT20_GROWTH_5YR)</span>
<span id="cb75-37"><a href="#cb75-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-38"><a href="#cb75-38" aria-hidden="true" tabindex="-1"></a>TOP20_BOT20_GROWTH_5YR <span class="sc">|&gt;</span></span>
<span id="cb75-39"><a href="#cb75-39" aria-hidden="true" tabindex="-1"></a>    <span class="fu">format_titles</span>() <span class="sc">|&gt;</span></span>
<span id="cb75-40"><a href="#cb75-40" aria-hidden="true" tabindex="-1"></a>    <span class="fu">head</span>(<span class="at">n=</span><span class="dv">40</span>) <span class="sc">|&gt;</span></span>
<span id="cb75-41"><a href="#cb75-41" aria-hidden="true" tabindex="-1"></a>    <span class="fu">datatable</span>(<span class="at">options=</span><span class="fu">list</span>(<span class="at">searching=</span><span class="cn">FALSE</span>, <span class="at">info=</span><span class="cn">FALSE</span>)) <span class="sc">|&gt;</span></span>
<span id="cb75-42"><a href="#cb75-42" aria-hidden="true" tabindex="-1"></a>    <span class="fu">formatRound</span>(<span class="fu">c</span>(<span class="st">'Pop Growth 5yr'</span>,<span class="st">'Housing Growth Rate'</span>, <span class="st">'Rate Scaled'</span>,<span class="st">'Housing Growth Instant'</span>, <span class="st">'Instant Scaled'</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div class="datatables html-widget html-fill-item" id="htmlwidget-06f21af17ff1775e8a0e" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-06f21af17ff1775e8a0e">{"x":{"filter":"none","vertical":false,"data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40"],[10540,12020,12060,13220,13380,17020,18700,19060,19460,19500,21820,23580,24300,24500,28140,29940,30620,31020,33140,33860,10180,10580,10740,11020,11100,12260,12540,12580,14260,14540,14740,15180,15540,15980,16540,16740,16940,16980,17140,17820],["Albany, OR Metro Area","Athens-Clarke County, GA Metro Area","Atlanta-Sandy Springs-Roswell, GA Metro Area","Beckley, WV Metro Area","Bellingham, WA Metro Area","Chico, CA Metro Area","Corvallis, OR Metro Area","Cumberland, MD-WV Metro Area","Decatur, AL Metro Area","Decatur, IL Metro Area","Fairbanks, AK Metro Area","Gainesville, GA Metro Area","Grand Junction, CO Metro Area","Great Falls, MT Metro Area","Kansas City, MO-KS Metro Area","Lawrence, KS Metro Area","Lima, OH Metro Area","Longview, WA Metro Area","Michigan City-La Porte, IN Metro Area","Montgomery, AL Metro Area","Abilene, TX Metro Area","Albany-Schenectady-Troy, NY Metro Area","Albuquerque, NM Metro Area","Altoona, PA Metro Area","Amarillo, TX Metro Area","Augusta-Richmond County, GA-SC Metro Area","Bakersfield, CA Metro Area","Baltimore-Columbia-Towson, MD Metro Area","Boise City, ID Metro Area","Bowling Green, KY Metro Area","Bremerton-Silverdale, WA Metro Area","Brownsville-Harlingen, TX Metro Area","Burlington-South Burlington, VT Metro Area","Cape Coral-Fort Myers, FL Metro Area","Chambersburg-Waynesboro, PA Metro Area","Charlotte-Concord-Gastonia, NC-SC Metro Area","Cheyenne, WY Metro Area","Chicago-Naperville-Elgin, IL-IN-WI Metro Area","Cincinnati, OH-KY-IN Metro Area","Colorado Springs, CO Metro Area"],[119356,197268,5611829,123373,208351,224241,86316,100530,153084,108350,99357,190761,148255,82344,2070221,116585,105040,102133,111444,374430,166900,880167,905213,125955,261752,583010,874589,2785874,666144,165928,254183,420392,215824,679513,152892,2380314,96389,9553810,2149971,686908],[2014,2014,2014,2014,2014,2014,2014,2014,2014,2014,2014,2014,2014,2014,2014,2014,2014,2014,2014,2014,2014,2014,2014,2014,2014,2014,2014,2014,2014,2014,2014,2014,2014,2014,2014,2014,2014,2014,2014,2014],[393,930,26683,125,1007,550,451,57,136,53,54,722,504,463,8201,347,61,178,125,1129,284,2231,2543,100,918,2847,2297,7100,5183,603,598,1417,706,4095,356,18537,403,15679,5206,3673],[2.377684759486722,2.625089739988139,2.468017026423385,55.79956305959312,3.949928654819042,1.661097938588339,4.492464136553478,0.7961017085104676,1.112953189915389,0.1349303168089904,0.7064666531522401,1.6075166584107,1.479879254995106,0.2020005354231059,0.1688172438419689,0.1735648677212308,0.6544841266038693,0.1637800835572642,0.3430485400178278,1.892645758214844,4.139368300200916,2.6323706377858,5.722504601642576,-0.1324114746039549,6.527967702025135,8.034437007553015,8.320710620542055,3.529989750587724,10.84424757851018,36.09691680541999,5.53055276465362,6.06023144982857,3.917414583413582,15.7784525002215,5.447121949873788,36.3667299905358,8.480203479865848,-0.2797212578031313,-0.9607854698760104,9.468980431591847],[165.2868398268398,354.2736028537456,10811.51374335072,2.240160910695695,254.9413136288998,331.1063045851528,100.3903395311237,71.59889168765744,122.197412462908,392.7953424657534,76.4367288378766,449.1399801192843,340.5683256244218,2292.07313253012,48579.16059615936,1999.252524752475,93.20317715959006,1086.823233532934,364.3799212598425,596.5194464414091,68.60950256255653,847.5250285714285,444.3858375002551,-755.2215568862275,140.6256957605985,354.3496572720144,276.0581523324701,2011.337284709648,477.9492502800325,16.70502783521552,108.1266241273178,233.8194525623413,180.2209046214356,259.5311549052427,65.3556140795138,509.7241353518486,47.52244459190445,-56052.22900518675,-5418.483275638874,387.8981508659138],[100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0.003292670665907035,0.004714398686051463,0.004754777809516292,0.001013187650458366,0.004833190145475664,0.00245271828077827,0.005224987256128644,0.0005669949268874963,0.0008884011392438139,0.0004891555145362252,0.000543494670732812,0.003784840716918028,0.003399548075950221,0.005622753327504129,0.003961412815346768,0.002976369172706609,0.0005807311500380807,0.00174282553141492,0.001121639567854707,0.003015249846433245,0.001701617735170761,0.002534746247019032,0.00280928356088567,0.0007939343416299473,0.00350713652617745,0.004883278159894341,0.002626376503706312,0.002548571830599661,0.007780599990392468,0.003634106359384793,0.002352635699476361,0.003370663571143124,0.003271183927644747,0.006026374771343594,0.002328440991026345,0.007787628018824407,0.004180975007521605,0.001641125373018722,0.002421428009959204,0.005347149836659349],[8.659922567304474,12.4308170491945,12.53791588364077,2.613977208751145,12.74589141819573,6.432090120272401,13.7850673658089,1.430526045565973,2.28300197306193,1.224070094533122,1.368195568146179,9.965320859532232,8.943396923904414,14.84007497794031,10.43364865654156,7.820986048910545,1.466959067456677,4.549218985021051,2.901627681320934,7.924110497420074,4.439922235385237,6.649655506109369,7.377819562289009,2.032444678842066,9.228757195017129,12.87874145315603,6.892689352541638,6.686325541513052,20.56340036687359,9.565523325123666,6.166637904224541,8.866785632401456,8.602932607481607,15.91061298083633,6.102465508877198,20.58204103038803,11.0160004475822,4.279476417758008,6.349097938999593,14.10908306662479]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>Geoid<\/th>\n      <th>Name<\/th>\n      <th>Population<\/th>\n      <th>Year<\/th>\n      <th>New Housing Units Permitted<\/th>\n      <th>Pop Growth 5yr<\/th>\n      <th>Housing Growth Rate<\/th>\n      <th>Rate Scaled<\/th>\n      <th>Housing Growth Instant<\/th>\n      <th>Instant Scaled<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"searching":false,"info":false,"columnDefs":[{"targets":6,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 2, 3, \",\", \".\", null);\n  }"},{"targets":7,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 2, 3, \",\", \".\", null);\n  }"},{"targets":8,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 2, 3, \",\", \".\", null);\n  }"},{"targets":9,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 2, 3, \",\", \".\", null);\n  }"},{"targets":10,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 2, 3, \",\", \".\", null);\n  }"},{"className":"dt-right","targets":[1,3,4,5,6,7,8,9,10]},{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"Geoid","targets":1},{"name":"Name","targets":2},{"name":"Population","targets":3},{"name":"Year","targets":4},{"name":"New Housing Units Permitted","targets":5},{"name":"Pop Growth 5yr","targets":6},{"name":"Housing Growth Rate","targets":7},{"name":"Rate Scaled","targets":8},{"name":"Housing Growth Instant","targets":9},{"name":"Instant Scaled","targets":10}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":["options.columnDefs.0.render","options.columnDefs.1.render","options.columnDefs.2.render","options.columnDefs.3.render","options.columnDefs.4.render"],"jsHooks":[]}</script>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a>TOP20_BOT20_GROWTH_INST <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(TOP20_GROWTH_INST, BOT20_GROWTH_INST)</span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true" tabindex="-1"></a>TOP20_BOT20_GROWTH_INST <span class="sc">|&gt;</span></span>
<span id="cb76-4"><a href="#cb76-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">format_titles</span>() <span class="sc">|&gt;</span></span>
<span id="cb76-5"><a href="#cb76-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">head</span>(<span class="at">n=</span><span class="dv">40</span>) <span class="sc">|&gt;</span></span>
<span id="cb76-6"><a href="#cb76-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">datatable</span>(<span class="at">options=</span><span class="fu">list</span>(<span class="at">searching=</span><span class="cn">FALSE</span>, <span class="at">info=</span><span class="cn">FALSE</span>)) <span class="sc">|&gt;</span></span>
<span id="cb76-7"><a href="#cb76-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">formatRound</span>(<span class="fu">c</span>(<span class="st">'Housing Growth Instant'</span>, <span class="st">'Instant Scaled'</span>, <span class="st">'Pop Growth 5yr'</span>,<span class="st">'Housing Growth Rate'</span>, <span class="st">'Rate Scaled'</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div class="datatables html-widget html-fill-item" id="htmlwidget-c1de453e2ea40838282d" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-c1de453e2ea40838282d">{"x":{"filter":"none","vertical":false,"data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40"],[41540,45540,34820,45540,39460,39460,34820,45540,34820,45540,12420,39460,41100,41100,43620,35840,34820,18880,41100,35840,34060,19180,48540,48260,48540,21820,19180,19180,19180,34060,48540,19180,21820,48540,19180,48540,34060,19180,21820,19180],["Salisbury, MD Metro Area","The Villages, FL Metro Area","Myrtle Beach-Conway-North Myrtle Beach, SC Metro Area","The Villages, FL Metro Area","Punta Gorda, FL Metro Area","Punta Gorda, FL Metro Area","Myrtle Beach-Conway-North Myrtle Beach, SC-NC Metro Area","The Villages, FL Metro Area","Myrtle Beach-Conway-North Myrtle Beach, SC-NC Metro Area","The Villages, FL Metro Area","Austin-Round Rock-Georgetown, TX Metro Area","Punta Gorda, FL Metro Area","St. George, UT Metro Area","St. George, UT Metro Area","Sioux Falls, SD Metro Area","North Port-Sarasota-Bradenton, FL Metro Area","Myrtle Beach-Conway-North Myrtle Beach, SC-NC Metro Area","Crestview-Fort Walton Beach-Destin, FL Metro Area","St. George, UT Metro Area","North Port-Sarasota-Bradenton, FL Metro Area","Morgantown, WV Metro Area","Danville, IL Metro Area","Wheeling, WV-OH Metro Area","Weirton-Steubenville, WV-OH Metro Area","Wheeling, WV-OH Metro Area","Fairbanks, AK Metro Area","Danville, IL Metro Area","Danville, IL Metro Area","Danville, IL Metro Area","Morgantown, WV Metro Area","Wheeling, WV-OH Metro Area","Danville, IL Micro Area","Fairbanks, AK Metro Area","Wheeling, WV-OH Metro Area","Danville, IL Metro Area","Wheeling, WV-OH Metro Area","Morgantown, WV Metro Area","Danville, IL Metro Area","Fairbanks, AK Metro Area","Danville, IL Metro Area"],[129710,135638,397478,144970,202661,194843,509794,114350,536165,132420,2352426,206134,177556,165662,289295,859760,464165,304818,191226,891411,140745,81509,141254,114106,136708,98971,78111,79282,80067,141817,144637,71652,100605,138948,73095,135517,141041,79728,99631,72337],[2023,2021,2023,2022,2022,2021,2021,2014,2022,2019,2021,2023,2019,2017,2022,2021,2017,2023,2021,2022,2021,2011,2017,2023,2022,2018,2016,2015,2009,2023,2009,2023,2016,2019,2021,2023,2022,2014,2015,2022],[4894,4611,13176,4439,5676,4830,12219,2570,12000,2928,50907,4429,3557,3209,5554,15924,8587,5596,3484,15780,21,12,20,16,18,13,10,10,10,17,17,8,11,12,6,11,11,6,7,2],[-68.04015246899739,14.08601155680413,-14.36708928936908,16.91506177618633,13.55784047292186,12.55119429281114,18.0177051791353,47.20459314375459,19.33473553010828,15.80236117184084,17.57074457983067,13.23990704982064,16.85313396688341,14.40034804466573,12.79480971151634,11.81426367961213,64.43133712382875,12.33554207543137,22.89430727111477,13.05765564894471,1.859223019916628,null,-3.528206529162683,-4.644671747559834,-4.38796491866109,-1.458640328169182,-4.168864787937529,-2.782308003580581,null,2.24066210555912,null,-8.031164563785955,1.424510041132349,-4.309080265831067,-7.803789006331828,-4.061477905050476,1.922965746495158,-0.4233954063471842,1.339585410012816,-7.392044654402069],[-71.9281163020609,327.3460327222786,-917.0959917225247,262.4288376084676,418.6507439246156,384.8239368556701,678.166274701272,54.44385448198751,620.6446414182112,185.2887659103486,2897.259121189194,334.5189647732459,211.0586676038738,222.8418361866398,434.0822665772794,1347.86224785892,133.2736581812184,453.6484870936902,152.1775679317314,1208.486456087185,11.2950408719346,null,-5.668602400309717,-3.444807484706729,-4.10212942301562,-8.912409556313992,-2.398734549735138,-3.594138386954606,null,7.587043114543113,null,-0.9961195461083586,7.721953290870488,-2.784817004954451,-0.7688572813964766,-2.708373714484923,5.72033070274333,-14.17115044247788,5.22549734244495,-0.270561136127468],[0,100,0,77.41296699592239,100,90.58270898738924,100,5.047491716309042,96.39422090688508,50.57315448819377,100,76.57794168801387,87.70791697230131,100,60.65038969934552,100,65.84306994601114,100,26.28374563431692,78.62764805443535,8.126246771549706,null,20.23342710389138,99.20440544116462,21.00952475364209,17.03242288131405,92.79128455981271,88.74211918469648,null,3.67126010231245,null,97.54233180466224,33.2026245764951,21.66217761549401,98.31213232285558,21.70005088808317,1.428492049583626,52.91483667652685,30.77582911820028,100],[0.03773032148639272,0.03399489818487444,0.03314900447320355,0.03062012830240739,0.028007362047952,0.02478918924467392,0.02396850492551893,0.0224748578924355,0.02238116997566048,0.02211146352514726,0.02164021312466365,0.02148602365451599,0.02003311631259997,0.01937076698337579,0.0191983961008659,0.01852144784591049,0.01849988689366928,0.01835849588935037,0.01821927980504743,0.01770227201593878,0.0001492060108707237,0.0001472230060484118,0.0001415889107565095,0.0001402204967311097,0.0001316674956842321,0.0001313516080468016,0.0001280229417111546,0.0001261320350142529,0.0001248954001024142,0.0001198727938117433,0.0001175356236647608,0.0001116507564338748,0.0001093385020625217,8.636324380343726e-05,8.208495793145906e-05,8.117062803928659e-05,7.799150601598117e-05,7.525586995785671e-05,7.025925665706457e-05,2.764836805507555e-05],[100,90.09241787765583,87.84882706112174,81.14140829837579,74.21148519649203,65.67582303488037,63.4990958925393,59.53744832342581,59.28895687964684,58.57360587610741,57.32369343885263,56.91473179927951,53.0611394098068,51.30436920111296,50.84718442281125,49.05169301871195,48.99450621879053,48.61949035751426,48.25024310582477,46.87896689024738,0.3224112052588798,0.3171516184489798,0.3022081281711989,0.2985786400945715,0.2758932431731589,0.2750554043375968,0.2662266766630385,0.2612113646426766,0.2579313985035192,0.2446097799675962,0.2384108291938755,0.2228022085201768,0.2166693426512353,0.1557313338607926,0.1443839000633271,0.141958793786903,0.1335267072520117,0.1262708926588711,0.1130182161573688,0]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>Geoid<\/th>\n      <th>Name<\/th>\n      <th>Population<\/th>\n      <th>Year<\/th>\n      <th>New Housing Units Permitted<\/th>\n      <th>Pop Growth 5yr<\/th>\n      <th>Housing Growth Rate<\/th>\n      <th>Rate Scaled<\/th>\n      <th>Housing Growth Instant<\/th>\n      <th>Instant Scaled<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"searching":false,"info":false,"columnDefs":[{"targets":9,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 2, 3, \",\", \".\", null);\n  }"},{"targets":10,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 2, 3, \",\", \".\", null);\n  }"},{"targets":6,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 2, 3, \",\", \".\", null);\n  }"},{"targets":7,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 2, 3, \",\", \".\", null);\n  }"},{"targets":8,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 2, 3, \",\", \".\", null);\n  }"},{"className":"dt-right","targets":[1,3,4,5,6,7,8,9,10]},{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"Geoid","targets":1},{"name":"Name","targets":2},{"name":"Population","targets":3},{"name":"Year","targets":4},{"name":"New Housing Units Permitted","targets":5},{"name":"Pop Growth 5yr","targets":6},{"name":"Housing Growth Rate","targets":7},{"name":"Rate Scaled","targets":8},{"name":"Housing Growth Instant","targets":9},{"name":"Instant Scaled","targets":10}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":["options.columnDefs.0.render","options.columnDefs.1.render","options.columnDefs.2.render","options.columnDefs.3.render","options.columnDefs.4.render"],"jsHooks":[]}</script>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a>HOUSING_GROWTH <span class="ot">&lt;-</span> HOUSING_GROWTH <span class="sc">%&gt;%</span></span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">composite_score =</span> <span class="fu">if_else</span>(</span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">is.na</span>(rate_scaled),instant_scaled,</span>
<span id="cb77-4"><a href="#cb77-4" aria-hidden="true" tabindex="-1"></a>    (instant_scaled <span class="sc">+</span> rate_scaled)<span class="sc">/</span><span class="dv">2</span></span>
<span id="cb77-5"><a href="#cb77-5" aria-hidden="true" tabindex="-1"></a>  ))</span>
<span id="cb77-6"><a href="#cb77-6" aria-hidden="true" tabindex="-1"></a>HOUSING_GROWTH</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 7,279 Ã— 11
   GEOID NAME             population  year new_housing_units_peâ€¦Â¹ pop_growth_5yr
   &lt;dbl&gt; &lt;chr&gt;                 &lt;dbl&gt; &lt;dbl&gt;                  &lt;dbl&gt;          &lt;dbl&gt;
 1 10140 Aberdeen, WA Miâ€¦      71797  2009                     NA             NA
 2 10180 Abilene, TX Metâ€¦     160266  2009                    214             NA
 3 10300 Adrian, MI Micrâ€¦      99837  2009                     NA             NA
 4 10380 Aguadilla-Isabeâ€¦     342495  2009                     NA             NA
 5 10420 Akron, OH Metroâ€¦     699935  2009                    741             NA
 6 10500 Albany, GA Metrâ€¦     164238  2009                    213             NA
 7 10540 Albany-Lebanon,â€¦     116584  2009                     NA             NA
 8 10580 Albany-Schenectâ€¦     857592  2009                   1380             NA
 9 10700 Albertville, ALâ€¦      90399  2009                     NA             NA
10 10740 Albuquerque, NMâ€¦     856216  2009                   1692             NA
# â„¹ 7,269 more rows
# â„¹ abbreviated name: Â¹â€‹new_housing_units_permitted
# â„¹ 5 more variables: housing_growth_rate &lt;dbl&gt;, rate_scaled &lt;dbl&gt;,
#   housing_growth_instant &lt;dbl&gt;, instant_scaled &lt;dbl&gt;, composite_score &lt;dbl&gt;</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a>TOP20_GROWTH_COMP <span class="ot">&lt;-</span> HOUSING_GROWTH <span class="sc">%&gt;%</span></span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_max</span>(<span class="at">order_by =</span> composite_score, <span class="at">n =</span> <span class="dv">20</span>, <span class="at">with_ties =</span> <span class="cn">FALSE</span>)</span>
<span id="cb79-3"><a href="#cb79-3" aria-hidden="true" tabindex="-1"></a>BOT20_GROWTH_COMP <span class="ot">&lt;-</span> HOUSING_GROWTH <span class="sc">%&gt;%</span></span>
<span id="cb79-4"><a href="#cb79-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_min</span>(<span class="at">order_by =</span> composite_score, <span class="at">n =</span> <span class="dv">20</span>, <span class="at">with_ties =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb79-5"><a href="#cb79-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(composite_score))</span>
<span id="cb79-6"><a href="#cb79-6" aria-hidden="true" tabindex="-1"></a>TOP20_BOT20_GROWTH_COMP <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(TOP20_GROWTH_COMP, BOT20_GROWTH_COMP)</span>
<span id="cb79-7"><a href="#cb79-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-8"><a href="#cb79-8" aria-hidden="true" tabindex="-1"></a>TOP20_BOT20_GROWTH_COMP <span class="sc">|&gt;</span></span>
<span id="cb79-9"><a href="#cb79-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">format_titles</span>() <span class="sc">|&gt;</span></span>
<span id="cb79-10"><a href="#cb79-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">head</span>(<span class="at">n=</span><span class="dv">40</span>) <span class="sc">|&gt;</span></span>
<span id="cb79-11"><a href="#cb79-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">datatable</span>(<span class="at">options=</span><span class="fu">list</span>(<span class="at">searching=</span><span class="cn">FALSE</span>, <span class="at">info=</span><span class="cn">FALSE</span>)) <span class="sc">|&gt;</span></span>
<span id="cb79-12"><a href="#cb79-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">formatRound</span>(<span class="fu">c</span>(<span class="st">'Housing Growth Instant'</span>, <span class="st">'Instant Scaled'</span>, <span class="st">'Pop Growth 5yr'</span>,<span class="st">'Housing Growth Rate'</span>, <span class="st">'Rate Scaled'</span>, <span class="st">'Composite Score'</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div class="datatables html-widget html-fill-item" id="htmlwidget-c314d945e2b1e526ee8b" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-c314d945e2b1e526ee8b">{"x":{"filter":"none","vertical":false,"data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40"],[45540,39460,34820,45540,12420,39460,34820,41100,35840,18880,24540,34940,29460,15980,38940,43300,25940,36100,34980,41100,48540,12980,26300,16180,19500,44600,22420,48540,29020,44600,19180,19180,22420,44600,19180,48260,19180,48540,34060,21820],["The Villages, FL Metro Area","Punta Gorda, FL Metro Area","Myrtle Beach-Conway-North Myrtle Beach, SC-NC Metro Area","The Villages, FL Metro Area","Austin-Round Rock-Georgetown, TX Metro Area","Punta Gorda, FL Metro Area","Myrtle Beach-Conway-North Myrtle Beach, SC-NC Metro Area","St. George, UT Metro Area","North Port-Sarasota-Bradenton, FL Metro Area","Crestview-Fort Walton Beach-Destin, FL Metro Area","Greeley, CO Metro Area","Naples-Marco Island, FL Metro Area","Lakeland-Winter Haven, FL Metro Area","Cape Coral-Fort Myers, FL Metro Area","Port St. Lucie, FL Metro Area","Sherman-Denison, TX Metro Area","Hilton Head Island-Bluffton, SC Metro Area","Ocala, FL Metro Area","Nashville-Davidson--Murfreesboro--Franklin, TN Metro Area","St. George, UT Metro Area","Wheeling, WV-OH Metro Area","Battle Creek, MI Metro Area","Hot Springs, AR Metro Area","Carson City, NV Metro Area","Decatur, IL Metro Area","Steubenville-Weirton, OH-WV Metro Area","Flint, MI Metro Area","Wheeling, WV-OH Metro Area","Kokomo, IN Metro Area","Steubenville-Weirton, OH-WV Metro Area","Danville, IL Metro Area","Danville, IL Metro Area","Flint, MI Metro Area","Steubenville-Weirton, OH-WV Metro Area","Danville, IL Metro Area","Weirton-Steubenville, WV-OH Metro Area","Danville, IL Metro Area","Wheeling, WV-OH Metro Area","Morgantown, WV Metro Area","Fairbanks, AK Metro Area"],[135638,202661,509794,144970,2352426,194843,536165,165662,859760,304818,350176,385980,753520,787976,503521,146907,222072,385915,2013506,177556,146420,136072,97322,55439,107303,124257,424926,147197,100485,122207,80727,81551,422080,123243,81509,119664,80067,144637,138380,99703],[2021,2022,2021,2022,2021,2021,2022,2017,2021,2023,2022,2021,2021,2021,2021,2023,2021,2021,2021,2019,2012,2010,2014,2011,2015,2010,2010,2011,2010,2012,2012,2010,2011,2011,2011,2017,2009,2009,2016,2017],[4611,5676,12219,4439,50907,4830,12000,3209,15924,5596,6166,6766,13071,13394,8403,2447,3698,6229,32191,3557,36,33,43,13,47,25,78,27,18,20,13,13,66,19,12,29,10,17,21,15],[14.08601155680413,13.55784047292186,18.0177051791353,16.91506177618633,17.57074457983067,12.55119429281114,19.33473553010828,14.40034804466573,11.81426367961213,12.33554207543137,18.7310973376914,8.025356488154378,15.90974815872215,12.25017165682311,10.70142421830686,12.02302882415739,7.067541571646907,12.42840578696825,10.00973611947344,16.85313396688341,null,null,-1.17486976918937,null,-3.081786569118909,null,null,null,null,null,null,null,null,null,null,-1.046068354158225,null,null,4.634369494370553,-0.5674565182703047],[327.3460327222786,418.6507439246156,678.166274701272,262.4288376084676,2897.259121189194,384.8239368556701,620.6446414182112,222.8418361866398,1347.86224785892,453.6484870936902,329.1851987546159,843.0778134263296,821.5717728274742,1093.372433890737,785.2225861325115,203.5260861292573,523.2371062146123,501.1905876561731,3215.968894262259,211.0586676038738,null,null,-36.59980121002593,null,-15.2508939038687,null,null,null,null,null,null,null,null,null,null,-27.72285375494071,null,null,4.531360744003916,-26.43374340949034],[100,100,100,77.41296699592239,100,90.58270898738924,96.39422090688508,100,100,100,100,100,100,100,100,100,100,100,100,87.70791697230131,null,null,0,null,0,null,null,null,null,null,null,null,null,null,null,0,null,null,0,0],[0.03399489818487444,0.028007362047952,0.02396850492551893,0.03062012830240739,0.02164021312466365,0.02478918924467392,0.02238116997566048,0.01937076698337579,0.01852144784591049,0.01835849588935037,0.01760828840354564,0.0175294056686875,0.01734658668648477,0.01699797963389748,0.01668847972577112,0.01665679647668253,0.01665225692568176,0.0161408600339453,0.01598753616825577,0.02003311631259997,0.0002458680508127305,0.0002425186665882768,0.0004418322681408109,0.0002344919641407673,0.0004380119847534552,0.0002011959084800052,0.0001835613730390703,0.0001834276513787645,0.0001791312136139722,0.000163656746340226,0.0001610365800785363,0.000159409449301664,0.0001563684609552691,0.000154166970943583,0.0001472230060484118,0.0002423452333199626,0.0001248954001024142,0.0001175356236647608,0.0001517560341089753,0.0001504468270764169],[90.09241787765583,74.21148519649203,63.4990958925393,81.14140829837579,57.32369343885263,65.67582303488037,59.28895687964684,51.30436920111296,49.05169301871195,48.61949035751426,46.62969116356841,46.42046797504128,45.93557136935787,45.01094978750581,44.19005332970046,44.10601883965477,44.09397844404006,42.73758419015961,42.33091842084322,53.0611394098068,0.5787910105809402,0.5699073321904427,1.098553141804385,0.5486178537963882,1.08842048257525,0.4603056655431691,0.4135330258802328,0.4131783516642001,0.4017827730236432,0.3607393509162069,0.353789800539591,0.3494741097879956,0.3414083996012138,0.3355693175690823,0.3171516184489798,0.569447329612456,0.2579313985035192,0.2384108291938755,0.3291747130617559,0.3257022615768198],[95.04620893882792,87.10574259824602,81.74954794626964,79.27718764714909,78.66184671942631,78.1292660111348,77.84158889326596,75.65218460055648,74.52584650935597,74.30974517875713,73.3148455817842,73.21023398752064,72.96778568467893,72.5054748937529,72.09502666485022,72.05300941982739,72.04698922202003,71.36879209507981,71.1654592104216,70.38452819105405,0.5787910105809402,0.5699073321904427,0.5492765709021924,0.5486178537963882,0.5442102412876251,0.4603056655431691,0.4135330258802328,0.4131783516642001,0.4017827730236432,0.3607393509162069,0.353789800539591,0.3494741097879956,0.3414083996012138,0.3355693175690823,0.3171516184489798,0.284723664806228,0.2579313985035192,0.2384108291938755,0.164587356530878,0.1628511307884099]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>Geoid<\/th>\n      <th>Name<\/th>\n      <th>Population<\/th>\n      <th>Year<\/th>\n      <th>New Housing Units Permitted<\/th>\n      <th>Pop Growth 5yr<\/th>\n      <th>Housing Growth Rate<\/th>\n      <th>Rate Scaled<\/th>\n      <th>Housing Growth Instant<\/th>\n      <th>Instant Scaled<\/th>\n      <th>Composite Score<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"searching":false,"info":false,"columnDefs":[{"targets":9,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 2, 3, \",\", \".\", null);\n  }"},{"targets":10,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 2, 3, \",\", \".\", null);\n  }"},{"targets":6,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 2, 3, \",\", \".\", null);\n  }"},{"targets":7,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 2, 3, \",\", \".\", null);\n  }"},{"targets":8,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 2, 3, \",\", \".\", null);\n  }"},{"targets":11,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 2, 3, \",\", \".\", null);\n  }"},{"className":"dt-right","targets":[1,3,4,5,6,7,8,9,10,11]},{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"Geoid","targets":1},{"name":"Name","targets":2},{"name":"Population","targets":3},{"name":"Year","targets":4},{"name":"New Housing Units Permitted","targets":5},{"name":"Pop Growth 5yr","targets":6},{"name":"Housing Growth Rate","targets":7},{"name":"Rate Scaled","targets":8},{"name":"Housing Growth Instant","targets":9},{"name":"Instant Scaled","targets":10},{"name":"Composite Score","targets":11}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":["options.columnDefs.0.render","options.columnDefs.1.render","options.columnDefs.2.render","options.columnDefs.3.render","options.columnDefs.4.render","options.columnDefs.5.render"],"jsHooks":[]}</script>
</div>
</div>
</section>
<section id="create-at-least-two-visualizations-to-investigate-the-relationships-between-your-rent-burden-and-housing-growth-metrics.-using-these-plots-identify-the-most-yimby-cbsas-as-ones-which" class="level3">
<h3 class="anchored" data-anchor-id="create-at-least-two-visualizations-to-investigate-the-relationships-between-your-rent-burden-and-housing-growth-metrics.-using-these-plots-identify-the-most-yimby-cbsas-as-ones-which">Create (at least) two visualizations to investigate the relationships between your Rent Burden and Housing Growth metrics. Using these plots, identify the most â€œYIMBYâ€ CBSAs as ones which:</h3>
<ol type="i">
<li>had relatively high rent burden in the early part of the study period;</li>
</ol>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb80-3"><a href="#cb80-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-4"><a href="#cb80-4" aria-hidden="true" tabindex="-1"></a>RENT_INCOME</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 7,279 Ã— 7
   GEOID NAME         monthly_rent  year household_income yearly_rent_burden_râ€¦Â¹
   &lt;dbl&gt; &lt;chr&gt;               &lt;dbl&gt; &lt;dbl&gt;            &lt;dbl&gt;                  &lt;dbl&gt;
 1 10140 Aberdeen, Wâ€¦          650  2009            36345                  0.215
 2 10180 Abilene, TXâ€¦          712  2009            42931                  0.199
 3 10300 Adrian, MI â€¦          645  2009            45640                  0.170
 4 10380 Aguadilla-Iâ€¦          363  2009            13470                  0.323
 5 10420 Akron, OH Mâ€¦          723  2009            47482                  0.183
 6 10500 Albany, GA â€¦          624  2009            36218                  0.207
 7 10540 Albany-Lebaâ€¦          761  2009            47669                  0.192
 8 10580 Albany-Scheâ€¦          833  2009            57677                  0.173
 9 10700 Albertvilleâ€¦          579  2009            37284                  0.186
10 10740 Albuquerqueâ€¦          726  2009            46824                  0.186
# â„¹ 7,269 more rows
# â„¹ abbreviated name: Â¹â€‹yearly_rent_burden_ratio
# â„¹ 1 more variable: rent_burden_scaled &lt;dbl&gt;</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a>HOUSING_GROWTH</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 7,279 Ã— 11
   GEOID NAME             population  year new_housing_units_peâ€¦Â¹ pop_growth_5yr
   &lt;dbl&gt; &lt;chr&gt;                 &lt;dbl&gt; &lt;dbl&gt;                  &lt;dbl&gt;          &lt;dbl&gt;
 1 10140 Aberdeen, WA Miâ€¦      71797  2009                     NA             NA
 2 10180 Abilene, TX Metâ€¦     160266  2009                    214             NA
 3 10300 Adrian, MI Micrâ€¦      99837  2009                     NA             NA
 4 10380 Aguadilla-Isabeâ€¦     342495  2009                     NA             NA
 5 10420 Akron, OH Metroâ€¦     699935  2009                    741             NA
 6 10500 Albany, GA Metrâ€¦     164238  2009                    213             NA
 7 10540 Albany-Lebanon,â€¦     116584  2009                     NA             NA
 8 10580 Albany-Schenectâ€¦     857592  2009                   1380             NA
 9 10700 Albertville, ALâ€¦      90399  2009                     NA             NA
10 10740 Albuquerque, NMâ€¦     856216  2009                   1692             NA
# â„¹ 7,269 more rows
# â„¹ abbreviated name: Â¹â€‹new_housing_units_permitted
# â„¹ 5 more variables: housing_growth_rate &lt;dbl&gt;, rate_scaled &lt;dbl&gt;,
#   housing_growth_instant &lt;dbl&gt;, instant_scaled &lt;dbl&gt;, composite_score &lt;dbl&gt;</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb84"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a>BURDEN_GROWTH <span class="ot">&lt;-</span> RENT_INCOME <span class="sc">%&gt;%</span></span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(HOUSING_GROWTH, <span class="fu">join_by</span>(year <span class="sc">==</span> year, NAME <span class="sc">==</span> NAME, GEOID <span class="sc">==</span> GEOID))</span>
<span id="cb84-3"><a href="#cb84-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-4"><a href="#cb84-4" aria-hidden="true" tabindex="-1"></a>BURDEN_GROWTH</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 7,279 Ã— 15
   GEOID NAME         monthly_rent  year household_income yearly_rent_burden_râ€¦Â¹
   &lt;dbl&gt; &lt;chr&gt;               &lt;dbl&gt; &lt;dbl&gt;            &lt;dbl&gt;                  &lt;dbl&gt;
 1 10140 Aberdeen, Wâ€¦          650  2009            36345                  0.215
 2 10180 Abilene, TXâ€¦          712  2009            42931                  0.199
 3 10300 Adrian, MI â€¦          645  2009            45640                  0.170
 4 10380 Aguadilla-Iâ€¦          363  2009            13470                  0.323
 5 10420 Akron, OH Mâ€¦          723  2009            47482                  0.183
 6 10500 Albany, GA â€¦          624  2009            36218                  0.207
 7 10540 Albany-Lebaâ€¦          761  2009            47669                  0.192
 8 10580 Albany-Scheâ€¦          833  2009            57677                  0.173
 9 10700 Albertvilleâ€¦          579  2009            37284                  0.186
10 10740 Albuquerqueâ€¦          726  2009            46824                  0.186
# â„¹ 7,269 more rows
# â„¹ abbreviated name: Â¹â€‹yearly_rent_burden_ratio
# â„¹ 9 more variables: rent_burden_scaled &lt;dbl&gt;, population &lt;dbl&gt;,
#   new_housing_units_permitted &lt;dbl&gt;, pop_growth_5yr &lt;dbl&gt;,
#   housing_growth_rate &lt;dbl&gt;, rate_scaled &lt;dbl&gt;, housing_growth_instant &lt;dbl&gt;,
#   instant_scaled &lt;dbl&gt;, composite_score &lt;dbl&gt;</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb86"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a>CBSA_METRICS <span class="ot">&lt;-</span> BURDEN_GROWTH <span class="sc">%&gt;%</span></span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(GEOID) <span class="sc">%&gt;%</span></span>
<span id="cb86-3"><a href="#cb86-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb86-4"><a href="#cb86-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">rent_burden_start =</span> <span class="fu">mean</span>(yearly_rent_burden_ratio[year <span class="sc">%in%</span> <span class="dv">2009</span><span class="sc">:</span><span class="dv">2011</span>], <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb86-5"><a href="#cb86-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">rent_burden_change =</span> yearly_rent_burden_ratio[year <span class="sc">==</span> <span class="fu">max</span>(year)] <span class="sc">-</span> yearly_rent_burden_ratio[year <span class="sc">==</span> <span class="fu">min</span>(year)],</span>
<span id="cb86-6"><a href="#cb86-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">pop_growth_total =</span> population[year <span class="sc">==</span> <span class="fu">max</span>(year)] <span class="sc">-</span> population[year <span class="sc">==</span> <span class="fu">min</span>(year)],                                                                         <span class="at">housing_growth_avg =</span> <span class="fu">mean</span>(composite_score, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)                   </span>
<span id="cb86-7"><a href="#cb86-7" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb86-8"><a href="#cb86-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb86-9"><a href="#cb86-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-10"><a href="#cb86-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-11"><a href="#cb86-11" aria-hidden="true" tabindex="-1"></a>rent_burden_threshold <span class="ot">&lt;-</span> <span class="fu">quantile</span>(CBSA_METRICS<span class="sc">$</span>rent_burden_start, <span class="fl">0.75</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb86-12"><a href="#cb86-12" aria-hidden="true" tabindex="-1"></a>housing_growth_threshold <span class="ot">&lt;-</span> <span class="fu">mean</span>(CBSA_METRICS<span class="sc">$</span>housing_growth_avg, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb86-13"><a href="#cb86-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-14"><a href="#cb86-14" aria-hidden="true" tabindex="-1"></a>YIMBY_CBSAs <span class="ot">&lt;-</span> CBSA_METRICS <span class="sc">%&gt;%</span></span>
<span id="cb86-15"><a href="#cb86-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(</span>
<span id="cb86-16"><a href="#cb86-16" aria-hidden="true" tabindex="-1"></a>    rent_burden_start <span class="sc">&gt;=</span> rent_burden_threshold,   <span class="co"># high initial rent burden</span></span>
<span id="cb86-17"><a href="#cb86-17" aria-hidden="true" tabindex="-1"></a>    rent_burden_change <span class="sc">&lt;</span> <span class="dv">0</span>,                        <span class="co"># rent burden decreased</span></span>
<span id="cb86-18"><a href="#cb86-18" aria-hidden="true" tabindex="-1"></a>    pop_growth_total <span class="sc">&gt;</span> <span class="dv">0</span>,                          <span class="co"># population grew</span></span>
<span id="cb86-19"><a href="#cb86-19" aria-hidden="true" tabindex="-1"></a>    housing_growth_avg <span class="sc">&gt;</span> housing_growth_threshold  <span class="co"># above-average housing growth</span></span>
<span id="cb86-20"><a href="#cb86-20" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb86-21"><a href="#cb86-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(housing_growth_avg))</span>
<span id="cb86-22"><a href="#cb86-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-23"><a href="#cb86-23" aria-hidden="true" tabindex="-1"></a>YIMBY_CBSAs</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 20 Ã— 5
   GEOID rent_burden_start rent_burden_change pop_growth_total
   &lt;dbl&gt;             &lt;dbl&gt;              &lt;dbl&gt;            &lt;dbl&gt;
 1 34820             0.236           -0.0137            133610
 2 42700             0.250           -0.00550             8910
 3 31740             0.223           -0.0229              9745
 4 25220             0.224           -0.00755            19376
 5 29700             0.234           -0.0280             27710
 6 27340             0.254           -0.0244             40612
 7 17780             0.275           -0.0224             67338
 8 41540             0.236           -0.0217              9529
 9 39460             0.261           -0.00345            49182
10 48900             0.225           -0.00504           112812
11 37860             0.226           -0.0111             74988
12 45220             0.251           -0.0182             33011
13 32580             0.228           -0.0215            157319
14 25060             0.240           -0.0298            178136
15 12700             0.232           -0.00332            10584
16 16820             0.215           -0.00568            26715
17 29940             0.217           -0.0369              4170
18 12020             0.224           -0.00119            27648
19 42680             0.233           -0.0126             34628
20 12100             0.227           -0.0181             98111
# â„¹ 1 more variable: housing_growth_avg &lt;dbl&gt;</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb88"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(CBSA_METRICS, <span class="fu">aes</span>(<span class="at">x =</span> rent_burden_change, <span class="at">y =</span> housing_growth_avg, <span class="at">color =</span> pop_growth_total)) <span class="sc">+</span></span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb88-3"><a href="#cb88-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> GEOID), <span class="at">check_overlap =</span> <span class="cn">TRUE</span>, <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.5</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb88-4"><a href="#cb88-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_gradient</span>(<span class="at">low =</span> <span class="st">"blue"</span>, <span class="at">high =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb88-5"><a href="#cb88-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb88-6"><a href="#cb88-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Change in Rent Burden (Final - Start)"</span>,</span>
<span id="cb88-7"><a href="#cb88-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Average Housing Growth (Composite Score)"</span>,</span>
<span id="cb88-8"><a href="#cb88-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"Population Growth"</span>,</span>
<span id="cb88-9"><a href="#cb88-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Rent Burden Change vs Housing Growth by CBSA"</span></span>
<span id="cb88-10"><a href="#cb88-10" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb88-11"><a href="#cb88-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="mp02_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb89"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(CBSA_METRICS, <span class="fu">aes</span>(<span class="at">x =</span> rent_burden_start, <span class="at">y =</span> housing_growth_avg, <span class="at">size =</span> pop_growth_total)) <span class="sc">+</span></span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb89-3"><a href="#cb89-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> GEOID), <span class="at">check_overlap =</span> <span class="cn">TRUE</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb89-4"><a href="#cb89-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb89-5"><a href="#cb89-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Starting Rent Burden (2009â€“2011)"</span>,</span>
<span id="cb89-6"><a href="#cb89-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Average Housing Growth"</span>,</span>
<span id="cb89-7"><a href="#cb89-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="st">"Population Growth"</span>,</span>
<span id="cb89-8"><a href="#cb89-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Early Rent Burden vs Housing Growth by CBSA"</span></span>
<span id="cb89-9"><a href="#cb89-9" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb89-10"><a href="#cb89-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="mp02_files/figure-html/unnamed-chunk-16-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb90"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(CBSA_METRICS, <span class="fu">aes</span>(<span class="at">x =</span> rent_burden_change, <span class="at">y =</span> housing_growth_avg)) <span class="sc">+</span></span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color =</span> GEOID <span class="sc">%in%</span> YIMBY_CBSAs<span class="sc">$</span>GEOID), <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span>  </span>
<span id="cb90-3"><a href="#cb90-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(</span>
<span id="cb90-4"><a href="#cb90-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> CBSA_METRICS <span class="sc">%&gt;%</span> <span class="fu">filter</span>(GEOID <span class="sc">%in%</span> YIMBY_CBSAs<span class="sc">$</span>GEOID),</span>
<span id="cb90-5"><a href="#cb90-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">label =</span> GEOID),</span>
<span id="cb90-6"><a href="#cb90-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.5</span>,</span>
<span id="cb90-7"><a href="#cb90-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="dv">3</span></span>
<span id="cb90-8"><a href="#cb90-8" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb90-9"><a href="#cb90-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"grey70"</span>, <span class="st">"green"</span>)) <span class="sc">+</span></span>
<span id="cb90-10"><a href="#cb90-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb90-11"><a href="#cb90-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Change in Rent Burden"</span>,</span>
<span id="cb90-12"><a href="#cb90-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Average Housing Growth"</span>,</span>
<span id="cb90-13"><a href="#cb90-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"YIMBY Candidate"</span></span>
<span id="cb90-14"><a href="#cb90-14" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb90-15"><a href="#cb90-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="mp02_files/figure-html/unnamed-chunk-16-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="policy-brief" class="level3">
<h3 class="anchored" data-anchor-id="policy-brief">POLICY BRIEF</h3>
<p>##Context America has had a long standing housing crisis that has driven rents to record highs and priced out millions of families out of their communities. While there are some cities that work to increase housing supplies and stabilize rents for families, there are many that continue to halt and slow development of affordable housing. Through our analysis, there are regions that embrace â€œYes In My Backyardâ€ (YIMBY) policies that both increase population growth as well as lower rent burden over the time of development, while restrictive â€œNot In My Backyardâ€ (NIMBY) policies show signs of higher costs and population stagnation.</p>
</section>
<section id="proposed-sponsors" class="level2">
<h2 class="anchored" data-anchor-id="proposed-sponsors">Proposed Sponsors</h2>
<p>A sponsor from Loredo, Texas and a cosponsor from Mrytle Beach, South Carolina would be a great step towards championing YIMBY as they are two of the major CBSAs that have shown proof of YIMBY benefits. They each experienced lowered rent burdens while also increasing household growth. Their success can be an indicator of further success and can champion the work we look to motivate the federal government to take action.</p>
</section>
<section id="how-we-can-gather-local-support" class="level2">
<h2 class="anchored" data-anchor-id="how-we-can-gather-local-support">How We can Gather Local Support</h2>
<p>As a developmental project, it would be beneficial to out reach to coalitions that would benefit from increased affordable housing development. The primary groups that would benefit would be the working class that would benefit from lowered rent burdens, this would include most people in the lower middle class such as service workers or essential workers. The other group that would heavily benefit from the policy change would be construction and building companies. The increase of federally funded development projects keeps more workers employed and plays into the longevity of job security in the sector as well as a promise of expense easing from the lowering rent burden.</p>
</section>
<section id="important-metrics-to-note" class="level2">
<h2 class="anchored" data-anchor-id="important-metrics-to-note">Important Metrics to Note</h2>
<p>The metric that stands out the most and helps our case the most is our Rent Burden metric that shows the amount of household income that is spent on rent. This is a telling data metric to show the direction that our policy action or lack there of would take on the community. The improvement in this metric as it declines overtime would indicate greater affordability and success in our favor. Another important metric would be housing growth as we desire to create sustained growth that could fight the demand for housing and increase population growth, bolstering the ecoonomy of that community.</p>
</section>
<section id="why-fight" class="level2">
<h2 class="anchored" data-anchor-id="why-fight">Why fight?</h2>
<p>This bill would give local governments the ability and incentive to help the working class and the people who keep the economy afloat. This bill would support working class families and combat the continuously increasing cost of living that wages do not keep up with. YIMBY is policy choice that chooses not to price people out and filter the less fortunate. It looks to be the tide that raises all ships, giving those who need it a leg to stand on.</p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "î§‹";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp("https:\/\/<ethantom625>\.github\.io\/STA9750-2025-FALL\/");
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




</body></html>